#Region AutoIt3Wrapper directives section
;========================================================================================================================
;~ Compiler directives.
;========================================================================================================================
;~ AutoIt3 Settings
;------------------------------------------------------------------------------------------------------------------------
#AutoIt3Wrapper_UseX64=Y
#AutoIt3Wrapper_Run_Debug_Mode=Y
#AutoIt3Wrapper_Run_Debug=On
;------------------------------------------------------------------------------------------------------------------------
;~ Aut2Exe Settings
;------------------------------------------------------------------------------------------------------------------------
#AutoIt3Wrapper_Icon=Resources\WinPower.ico
#AutoIt3Wrapper_OutFile=Doors.exe
#AutoIt3Wrapper_OutFile_X64=Doors_x64.exe
#AutoIt3Wrapper_Compression=4
#AutoIt3Wrapper_UseUpx=Y
#AutoIt3Wrapper_Compile_both=Y
;------------------------------------------------------------------------------------------------------------------------
;~ Resource Information
;------------------------------------------------------------------------------------------------------------------------
#AutoIt3Wrapper_Res_Comment=Complete Windows Repair
#AutoIt3Wrapper_Res_Description=Rizonesoft Doors
#AutoIt3Wrapper_Res_Fileversion=0.0.0.629
#AutoIt3Wrapper_Res_FileVersion_AutoIncrement=Y
#AutoIt3Wrapper_Res_LegalCopyright=Copyright © 2015 Rizonesoft
#AutoIt3Wrapper_res_requestedExecutionLevel=requireAdministrator
#AutoIt3Wrapper_res_Compatibility=Vista,win7,win8,win81
#AutoIt3Wrapper_Res_SaveSource=Y

#AutoIt3Wrapper_Res_Icon_Add=Resources\RunB.ico ;~ 201
#AutoIt3Wrapper_Res_Icon_Add=Resources\Run.ico ;~ 202
#AutoIt3Wrapper_Res_Icon_Add=Resources\InfoB.ico ;~ 203
#AutoIt3Wrapper_Res_Icon_Add=Resources\Info.ico ;~ 204
#AutoIt3Wrapper_Res_Icon_Add=Resources\Complete.ico ;~ 205
#AutoIt3Wrapper_Res_Icon_Add=Resources\Gear.ico ;~ 206
#AutoIt3Wrapper_Res_Icon_Add=Resources\Facebook.ico ;~ 207
#AutoIt3Wrapper_Res_Icon_Add=Resources\Twitter.ico ;~ 208
#AutoIt3Wrapper_Res_Icon_Add=Resources\LinkedIn.ico ;~ 209
#AutoIt3Wrapper_Res_Icon_Add=Resources\Google.ico ;~ 210
#AutoIt3Wrapper_Res_Icon_Add=Resources\RSS.ico ;~ 211
#AutoIt3Wrapper_Res_Icon_Add=Resources\PP.ico ;~ 212
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 213
#AutoIt3Wrapper_Res_Icon_Add=Resources\Memory_Off.ico ;~ 214
#AutoIt3Wrapper_Res_Icon_Add=Resources\Memory.ico ;~ 215
#AutoIt3Wrapper_Res_Icon_Add=Resources\CPU_Off.ico ;~ 216
#AutoIt3Wrapper_Res_Icon_Add=Resources\CPU.ico ;~ 217
#AutoIt3Wrapper_Res_Icon_Add=Resources\Computer_Off.ico ;~ 218
#AutoIt3Wrapper_Res_Icon_Add=Resources\Computer.ico ;~ 219
#AutoIt3Wrapper_Res_Icon_Add=Resources\ControlPanel.ico ;~ 220
#AutoIt3Wrapper_Res_Icon_Add=Resources\ControlPanel.ico ;~ 221
#AutoIt3Wrapper_Res_Icon_Add=Resources\BinFull_Off.ico ;~ 222
#AutoIt3Wrapper_Res_Icon_Add=Resources\BinFull.ico ;~ 223
#AutoIt3Wrapper_Res_Icon_Add=Resources\Bin_Off.ico ;~ 224
#AutoIt3Wrapper_Res_Icon_Add=Resources\Bin.ico ;~ 225

#AutoIt3Wrapper_Res_Icon_Add=Resources\Windows_Off.ico ;~ 226
#AutoIt3Wrapper_Res_Icon_Add=Resources\Windows_On.ico ;~ 227
#AutoIt3Wrapper_Res_Icon_Add=Resources\Processor32Bit.ico ;~ 228
#AutoIt3Wrapper_Res_Icon_Add=Resources\Processor64Bit.ico ;~ 229
#AutoIt3Wrapper_Res_Icon_Add=Resources\Portable_Off.ico ;~ 230
#AutoIt3Wrapper_Res_Icon_Add=Resources\Portable_On.ico ;~ 231
#AutoIt3Wrapper_Res_Icon_Add=Resources\SFC.ico ;~ 232
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 233
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 234
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 235
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 236
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 237
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 238
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 239
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 240
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 241
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 242
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 243
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 244
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 245
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 246
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 247
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 248
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 249
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 250

#AutoIt3Wrapper_Res_Icon_Add=Resources\Malware\RemMalware.ico ;~ 251
#AutoIt3Wrapper_Res_Icon_Add=Resources\Accociations\dll.ico ;~ 252
#AutoIt3Wrapper_Res_Icon_Add=Resources\Accociations\lnk.ico ;~ 253
#AutoIt3Wrapper_Res_Icon_Add=Resources\Accociations\reg.ico ;~ 254
#AutoIt3Wrapper_Res_Icon_Add=Resources\Accociations\exe.ico ;~ 255
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 256
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 257
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 258
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 259
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 260
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 261
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 262
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 263
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 264
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 265

#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 266
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 267
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 268
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 269
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 270
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 271
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 272
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 273
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 274
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 275
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 276
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 277
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 278
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 279
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 280

#AutoIt3Wrapper_Res_Icon_Add=Resources\Desktop\Aero.ico ;~ 281
#AutoIt3Wrapper_Res_Icon_Add=Resources\Desktop\IcoDBSize.ico ;~ 282
#AutoIt3Wrapper_Res_Icon_Add=Resources\Desktop\IcoView.ico ;~ 283
#AutoIt3Wrapper_Res_Icon_Add=Resources\Desktop\RecCorr.ico ;~ 284
#AutoIt3Wrapper_Res_Icon_Add=Resources\Desktop\RecBCh.ico ;~ 285
#AutoIt3Wrapper_Res_Icon_Add=Resources\Desktop\RecBin.ico ;~ 286
#AutoIt3Wrapper_Res_Icon_Add=Resources\Desktop\RBRemDel.ico ;~ 287
#AutoIt3Wrapper_Res_Icon_Add=Resources\Desktop\Sidebar.ico ;~ 288
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 289
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 290
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 291
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 292
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 293
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 294
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 295

#AutoIt3Wrapper_Res_Icon_Add=Resources\Accociations\exe.ico ;~ 276
#AutoIt3Wrapper_Res_Icon_Add=Resources\Accociations\dll.ico ;~ 277
#AutoIt3Wrapper_Res_Icon_Add=Resources\Accociations\lnk.ico ;~ 278
#AutoIt3Wrapper_Res_Icon_Add=Resources\Accociations\reg.ico ;~ 279
#AutoIt3Wrapper_Res_Icon_Add=Resources\Accociations\exe.ico ;~ 280
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 256
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 257
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 258
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 259
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 260
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 261
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 262
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 263
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 264
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 265
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 266
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 267
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 268
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 269
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 270
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 271
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 272
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 273
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 274
#AutoIt3Wrapper_Res_Icon_Add=Resources\Placeholder.ico ;~ 275

;------------------------------------------------------------------------------------------------------------------------
; Au3Stripper Settings
;------------------------------------------------------------------------------------------------------------------------
;~ #AutoIt3Wrapper_Run_Au3Stripper=Y
;~ #Au3Stripper_Parameters=/PreExpand /StripUnusedFunc=1 /StripUnusedVars=1 ;~ /RenameMinimum
#Au3Stripper_Parameters=/MergeOnly
;------------------------------------------------------------------------------------------------------------------------
;~ Versioning Settings
;------------------------------------------------------------------------------------------------------------------------
#AutoIt3Wrapper_Versioning=N
#AutoIt3Wrapper_Versioning_Parameters=/NoPrompt
;========================================================================================================================
#EndRegion


#RequireAdmin


Opt("GUICloseOnESC", 1)
Opt("GUIOnEventMode", 1)
Opt("MustDeclareVars", 1)
Opt("GUIResizeMode", 802) ;~ For GUI Expander to work!
Opt("TrayIconDebug", 1)


#include <ListBoxConstants.au3>
#include <StaticConstants.au3>
#include <GuiConstantsEx.au3>
#include <TabConstants.au3>
#include <GuiButton.au3>
#include <Misc.au3>

#include "UDF\Components_Desktop.au3"
#include "UDF\CoreConstants.au3"
#include "UDF\CoreFunctions.au3"
#include "UDF\Initialise.au3"
#include "UDF\Logging.au3"


Global $iEventError = 0 ; to be checked to know if com error occurs. Must be reset after handling.
Global $oErrorHandler = ObjEvent("AutoIt.Error", "_ComErrHandler") ; Install a custom error handler

; Perform a deliberate failure (the object doesn't exist)
; Local $oIE = ObjCreate("InternetExplorer.Application")
; $oIE.visible = 1
; $oIE.bogus
; If $iEventError Then
    ; MsgBox(0, "", "There was an error on the previous line.")
    ; $iEventError = 0 ; Reset after displaying a COM Error occurred
; EndIf




;========================================================================================================================
;~ Declarations
;========================================================================================================================
;~ GUI
;------------------------------------------------------------------------------------------------------------------------
Global $GUI_CORE, $GUI_COREHANDLE, $GUI_RETRACTED = True, $GUI_COORDS, $BTN_GUIEXTEND
Global $DLG_ABOUT
;------------------------------------------------------------------------------------------------------------------------
;~ Mini System Panel
;------------------------------------------------------------------------------------------------------------------------
Global $ICON_MEMORY16, $ICON_PROCESSOR16, $MEM_BUFFER1, $MEM_BUFFER2
Global $BAR_MEMORY_USAGE, $LBL_MEMORY_USAGE, $BAR_PROCESSOR_USAGE, $LBL_PROCESSOR_USAGE, $BAR_PAGE_USAGE, $LBL_PAGE_USAGE
Global $IDLETIME, $KERNELTIME, $USERTIME
Global $START_IDLE, $START_KERNEL, $START_USER
Global $END_IDLE, $END_KERNEL, $END_USER

Global Const $ANI_PROCESS = @ScriptDir & "\Doors\Data\WinRepair\Process.ani"

Global Const $BTNHOMESTART	= 80
Global Const $BTNPAGECOUNT	= 10
Global Const $BTNPAGEHEIGHT	= 28
Global Const $BTNHOMECOUNT  = 6
Global Const $PAGECOUNT = 4
Global Const $LINESPACING = 20
Global Const $COUNT_MALWARE1 = 1
Global Const $COUNT_DESKTOP1 = 8
Global Const $COUNT_ASSOCIATIONS1 = 18
Global Const $COUNT_ASSOCIATIONS2 = 18
Global Const $COUNT_ASSOCIATIONS3 = 18
Global Const $COUNT_ASSOCIATIONS4 = 18

Global $ICON_PAGES, $LST_STATUS, $EDIT_INFO
Global $BTN_HOME[$BTNHOMECOUNT], $BTN_INDPAGE[$BTNPAGECOUNT], $BTN_INDPAGE2[$BTNPAGECOUNT], $BTN_INDPAGE3[$BTNPAGECOUNT]
Global $BTN_INDTRBLSHOOT[$BTNPAGECOUNT], $BTN_INDRUN[$BTNPAGECOUNT]
Global $PAGE_HOME[$BTNHOMECOUNT]
Global $PAGE_MALWARE[$PAGECOUNT], $BTN_MALTROUBLESHOOT, $ICON_MALWARE1[$COUNT_MALWARE1], $CHK_MALWARE1[$COUNT_MALWARE1]
Global $BTNHLP_MALWARE1[$COUNT_MALWARE1], $BTNGO_MALWARE1[$COUNT_MALWARE1], $BTN_MALWAREBACK1, $BTN_MALWARENEXT1
Global $PRGTOP_MALWARE1[$COUNT_MALWARE1], $LINE_MALWARE1[$COUNT_MALWARE1], $PROGRESS_MALWARE1[$COUNT_MALWARE1]
Global $PAGE_SYSTEM[$PAGECOUNT], $BTN_SYSTROUBLESHOOT
Global $PAGE_DESKTOP[$PAGECOUNT], $BTN_DESKTOPTROUBLESHOOT, $BTN_DESKTOPBACK1, $BTN_DESKTOPNEXT1, $ICON_DESKTOP1[$COUNT_DESKTOP1]
Global $CHK_DESKTOP1[$COUNT_DESKTOP1], $BTNHLP_DESKTOP1[$COUNT_DESKTOP1], $BTNGO_DESKTOP1[$COUNT_DESKTOP1]
Global $PRGTOP_DESKTOP1[$COUNT_DESKTOP1], $LINE_DESKTOP1[$COUNT_DESKTOP1], $PROGRESS_DESKTOP1[$COUNT_DESKTOP1]
Global $PAGE_EXPLORER[$BTNHOMECOUNT], $PAGE_INTERNET[$PAGECOUNT], $PAGE_HARDWARE[$PAGECOUNT], $PAGE_PROGRAMS[$PAGECOUNT]
Global $PAGE_ASSOCIATIONS[$BTNHOMECOUNT], $PAGE_SECURITY[$PAGECOUNT], $PAGE_PERFORMANCE[$PAGECOUNT]
Global $ICON_ASSOCIATIONS1[$COUNT_ASSOCIATIONS1], $CHK_ASSOCIATIONS1[$COUNT_ASSOCIATIONS1]
Global $BTNHLP_ASSOCIATIONS1[$COUNT_ASSOCIATIONS1], $BTNGO_ASSOCIATIONS1[$COUNT_ASSOCIATIONS1]
Global $PRGTOP_ASSOCIATIONS1[$COUNT_ASSOCIATIONS1], $LINE_ASSOCIATIONS1[$COUNT_ASSOCIATIONS1]
Global $PROGRESS_ASSOCIATIONS1[$COUNT_ASSOCIATIONS1], $ICON_ASSOCIATIONS2[$COUNT_ASSOCIATIONS2]
Global $CHK_ASSOCIATIONS2[$COUNT_ASSOCIATIONS2], $BTNHLP_ASSOCIATIONS2[$COUNT_ASSOCIATIONS2]
Global $BTNGO_ASSOCIATIONS2[$COUNT_ASSOCIATIONS2], $PRGTOP_ASSOCIATIONS2[$COUNT_ASSOCIATIONS2]
Global $LINE_ASSOCIATIONS2[$COUNT_ASSOCIATIONS2], $PROGRESS_ASSOCIATIONS2[$COUNT_ASSOCIATIONS2]
Global $ICON_ASSOCIATIONS3[$COUNT_ASSOCIATIONS3], $CHK_ASSOCIATIONS3[$COUNT_ASSOCIATIONS3]
Global $BTNHLP_ASSOCIATIONS3[$COUNT_ASSOCIATIONS3], $BTNGO_ASSOCIATIONS3[$COUNT_ASSOCIATIONS3]
Global $PRGTOP_ASSOCIATIONS3[$COUNT_ASSOCIATIONS3], $LINE_ASSOCIATIONS3[$COUNT_ASSOCIATIONS3]
Global $PROGRESS_ASSOCIATIONS3[$COUNT_ASSOCIATIONS3], $ICON_ASSOCIATIONS4[$COUNT_ASSOCIATIONS4]
Global $CHK_ASSOCIATIONS4[$COUNT_ASSOCIATIONS4], $BTNHLP_ASSOCIATIONS4[$COUNT_ASSOCIATIONS4]
Global $BTNGO_ASSOCIATIONS4[$COUNT_ASSOCIATIONS4], $PRGTOP_ASSOCIATIONS4[$COUNT_ASSOCIATIONS4]
Global $LINE_ASSOCIATIONS4[$COUNT_ASSOCIATIONS4], $PROGRESS_ASSOCIATIONS4[$COUNT_ASSOCIATIONS4]
Global $BTNGO_ALL

Global $DIR_DOORS = @ScriptDir & "\Doors"
Global $EXE_BIOSCODES = $DIR_DOORS & "\BIOSCodes.exe"
Global $EXE_QUICKERASE = $DIR_DOORS & "\QuickErase.exe"
Global $EXE_INDICATORS = $DIR_DOORS & "\Indicators.exe"


;========================================================================================================================

	If _Singleton (_GUIGetTitle($PROG_NAME), 1) = 0 Then
		MsgBox($MB_SYSTEMMODAL + $MB_ICONINFORMATION, 	"Warning", "Another occurence of " & $PROG_NAME & _
														" is already running. This message will self-destruct in " & _
														$CONF_MSGTIMEOUT & " seconds.", $CONF_MSGTIMEOUT)
		Exit
	Else


		_SplashStart("Loading Complete Windows Repair")
		_SplashUpdate("", 1)
		_LoggingInitialize()
		_SplashUpdate("", 2)
		_StartCoreGUI()

	EndIf


Func _StartCoreGUI()

	$IDLETIME   = DllStructCreate("dword;dword")
	$KERNELTIME = DllStructCreate("dword;dword")
	$USERTIME   = DllStructCreate("dword;dword")

	_SplashUpdate("", 3)
	_LoggingWrite("Starting Complete Windows Repair")


	$GUI_CORE = GUICreate(_GUIGetTitle($PROG_NAME), 750, 530, -1, -1, -1)
	GUISetFont(8.5, 400, -1, "Verdana", $GUI_CORE, $CLEARTYPE_QUALITY)

	$GUI_COREHANDLE = WinGetHandle($GUI_CORE)
	$GUI_COORDS = WinGetPos($GUI_COREHANDLE)


	$ICON_PAGES = GUICtrlCreateIcon(@ScriptFullPath, 99, 10, 10, 48, 48)

	;========================================================================================================================
	;~ Complete Windows Repair Menus
	;========================================================================================================================
	;~ Home Menu
	;------------------------------------------------------------------------------------------------------------------------
	_SplashUpdate("", 4)
	Local $mnuHome, $mnuiHomeClose

	$mnuHome = GUICtrlCreateMenu("Ho&me")

	$mnuiHomeClose = GUICtrlCreateMenuItem("Close" & @TAB & "Esc", $mnuHome)

	GUICtrlSetOnEvent($mnuiHomeClose, "_CloseWindowsRepair")

	;------------------------------------------------------------------------------------------------------------------------
	;~ Maintenance Menu
	;------------------------------------------------------------------------------------------------------------------------
	_SplashUpdate("", 5)
	Local $mnuMaintenance, $mnuiManSysRestore

	$mnuMaintenance = GUICtrlCreateMenu("&Maintenance")
	$mnuiManSysRestore = GUICtrlCreateMenuItem("System &Restore", $mnuMaintenance)

	;GUICtrlSetOnEvent($mnuiAccIndicators, "_OpenIndicators")

	;------------------------------------------------------------------------------------------------------------------------
	;~ Accessories Menu
	;----------------------------------------------------------------------------------------------------------------------
	_SplashUpdate("", 6)
	Local $mnuAccessories, $mnuiAccIndicators

	$mnuAccessories = GUICtrlCreateMenu("&Accessories")
	$mnuiAccIndicators = GUICtrlCreateMenuItem("&Indicators", $mnuAccessories)

	GUICtrlSetOnEvent($mnuiAccIndicators, "_OpenIndicators")

	;------------------------------------------------------------------------------------------------------------------------
	;~ Hardware Menu
	;------------------------------------------------------------------------------------------------------------------------
	_SplashUpdate("", 7)
	Local $mnuHardware, $mnuiHardBCodes

	$mnuHardware = GUICtrlCreateMenu("Hard&ware")
	$mnuiHardBCodes = GUICtrlCreateMenuItem("Motherboard &POST Beep Codes", $mnuHardware)

	;~ GUICtrlSetState($mnuiHardBCodes, $GUI_DISABLE)

	GUICtrlSetOnEvent($mnuiHardBCodes, "_OpenBIOSCodes")

	;------------------------------------------------------------------------------------------------------------------------

	;------------------------------------------------------------------------------------------------------------------------
	;~ Security Menu
	;------------------------------------------------------------------------------------------------------------------------
	_SplashUpdate("", 8)
	Local $mnuSecurity, $mnuiQuickErase

	$mnuSecurity = GUICtrlCreateMenu("&Security")
	$mnuiQuickErase = GUICtrlCreateMenuItem("Quick &Erase", $mnuSecurity)

	;~ GUICtrlSetState($mnuiQuickErase, $GUI_DISABLE)

	GUICtrlSetOnEvent($mnuiQuickErase, "_OpenQuickErase")

	;------------------------------------------------------------------------------------------------------------------------

	;------------------------------------------------------------------------------------------------------------------------
	;~ Help Menu
	;------------------------------------------------------------------------------------------------------------------------
	_SplashUpdate("", 9)
	Local $mnuHelp, $mnuiHlpAbout

	$mnuHelp = GUICtrlCreateMenu("&Help")
	$mnuiHlpAbout = GUICtrlCreateMenuItem("&About Doors", $mnuHelp)

	GUICtrlSetOnEvent($mnuiHlpAbout, "_AboutDlg")

	;------------------------------------------------------------------------------------------------------------------------

	;~ If FileExists($EXE_BIOSCODES) Then GUICtrlSetState($mnuiHardBCodes, $GUI_ENABLE)
	;~ If FileExists($EXE_QUICKERASE) Then GUICtrlSetState($mnuiQuickErase, $GUI_ENABLE)

	;========================================================================================================================

	;========================================================================================================================
	;~ Mini System Panel
	;========================================================================================================================
	;~ Memory Usage
	;------------------------------------------------------------------------------------------------------------------------
	$ICON_MEMORY16 = GUICtrlCreateIcon(@ScriptFullPath, 214, 77, 6, 16, 16)
;~ 	GUICtrlSetTip($ICON_MEMORY16, 	"Click for memory optimizations." & @CR & _
;~ 									"Right click for more options.", "Memory Usage", 1, 1)
	GUICtrlSetCursor($ICON_MEMORY16, 0)

	GUICtrlCreateLabel("", 100, 10, 100, 8)
	GUICtrlSetBkColor(-1, 0x071320)
	$BAR_MEMORY_USAGE = GUICtrlCreateLabel("", 101, 11, 10, 6)
	GUICtrlSetBkColor($BAR_MEMORY_USAGE, 0x68CEFA)
	$LBL_MEMORY_USAGE = GUICtrlCreateLabel("100 %", 200, 8, 40, 11, $SS_RIGHT)
	GUICtrlSetFont($LBL_MEMORY_USAGE, 7, 400, -1, "Tahoma", 5)
	GUICtrlSetColor($LBL_MEMORY_USAGE, 0x555555)

	GUICtrlCreateLabel("", 100, 20, 100, 8)
	GUICtrlSetBkColor(-1, 0x071320)
	$BAR_PAGE_USAGE = GUICtrlCreateLabel("", 101, 21, 50, 6)
	GUICtrlSetBkColor($BAR_PAGE_USAGE, 0xFABA00)
	$LBL_PAGE_USAGE = GUICtrlCreateLabel("100 %", 200, 19, 40, 11, $SS_RIGHT)
	GUICtrlSetFont($LBL_PAGE_USAGE, 7, 400, -1, "Tahoma", 5)
	GUICtrlSetColor($LBL_PAGE_USAGE, 0x3555555)
	;------------------------------------------------------------------------------------------------------------------------
	;~ Processor Usage
	;------------------------------------------------------------------------------------------------------------------------
	$ICON_PROCESSOR16 = GUICtrlCreateIcon(@ScriptFullPath, 216, 77, 30, 16, 16)
	GUICtrlSetCursor($ICON_PROCESSOR16, 0)

	GUICtrlCreateLabel("", 100, 33, 100, 12)
	GUICtrlSetBkColor(-1, 0x071320)
	$BAR_PROCESSOR_USAGE = GUICtrlCreateLabel("", 101, 34, 50, 10)
	GUICtrlSetBkColor(-1, 0x7CCC7C)
	$LBL_PROCESSOR_USAGE = GUICtrlCreateLabel("100 %", 200, 32, 40, 11, $SS_RIGHT)
	GUICtrlSetFont($LBL_PROCESSOR_USAGE, 7, 400, -1, "Tahoma", 5)
	GUICtrlSetColor($LBL_PROCESSOR_USAGE, 0x555555)
	;------------------------------------------------------------------------------------------------------------------------

	GUICtrlCreateLabel("", 250, -10, 1, 73)
	GUICtrlSetBkColor(-1, 0xC0C0C0)
	GUICtrlCreateLabel("", 251, -10, 1, 72)
	GUICtrlSetBkColor(-1, 0xFFFFFF)

	GUICtrlCreateIcon(@ScriptFullPath, 218, 256, 3, 16, 16)
	GUICtrlCreateIcon(@ScriptFullPath, 221, 256, 21, 16, 16)
	GUICtrlCreateIcon(@ScriptFullPath, 224, 256, 41, 16, 16)

	GUICtrlCreateLabel("", 277, -10, 1, 72)
	GUICtrlSetBkColor(-1, 0xFFFFFF)
	GUICtrlCreateLabel("", 278, -10, 1, 73)
	GUICtrlSetBkColor(-1, 0xC0C0C0)

	GUICtrlCreateLabel("", 251, 61, 27, 1)
	GUICtrlSetBkColor(-1, 0xFFFFFF)
	GUICtrlCreateLabel("", 250, 62, 29, 1)
	GUICtrlSetBkColor(-1, 0xC0C0C0)

	$BTN_HOME[0] = GUICtrlCreateCheckbox(Chr(32) & Chr(32) & "Home", 10, $BTNHOMESTART, 100, $BTNPAGEHEIGHT, BitOR($BS_PUSHLIKE, $BS_LEFT))
	$BTN_HOME[1] = GUICtrlCreateCheckbox("1", 110, $BTNHOMESTART, 35, $BTNPAGEHEIGHT, $BS_PUSHLIKE)
	$BTN_HOME[2] = GUICtrlCreateCheckbox("2", 145, $BTNHOMESTART, 35, $BTNPAGEHEIGHT, $BS_PUSHLIKE)
	$BTN_HOME[3] = GUICtrlCreateCheckbox("3", 180, $BTNHOMESTART, 35, $BTNPAGEHEIGHT, $BS_PUSHLIKE)
	$BTN_HOME[4] = GUICtrlCreateCheckbox("4", 215, $BTNHOMESTART, 35, $BTNPAGEHEIGHT, $BS_PUSHLIKE)
	$BTN_HOME[5] = GUICtrlCreateCheckbox("~", 250, $BTNHOMESTART, 30, $BTNPAGEHEIGHT, $BS_PUSHLIKE)
	GUICtrlSetFont($BTN_HOME[5], 12, 400, -1, "Webdings")

	For $iHB = 0 To UBound($BTN_HOME) - 1
		GUICtrlSetOnEvent($BTN_HOME[$iHB], "_SelectPage")
	Next

	For $iIB = 0 To UBound($BTN_INDPAGE) - 1
		$BTN_INDPAGE[$iIB] = GUICtrlCreateCheckbox(Chr(32) & Chr(32) & "Page " & $iIB, 10, $BTNHOMESTART + $BTNPAGEHEIGHT + ($iIB * $BTNPAGEHEIGHT), 135, $BTNPAGEHEIGHT, BitOR($BS_PUSHLIKE, $BS_LEFT))
		$BTN_INDPAGE2[$iIB] = GUICtrlCreateCheckbox("2", 145, $BTNHOMESTART + $BTNPAGEHEIGHT + ($iIB * $BTNPAGEHEIGHT), 35, $BTNPAGEHEIGHT, $BS_PUSHLIKE)
		$BTN_INDPAGE3[$iIB] = GUICtrlCreateCheckbox("3", 180, $BTNHOMESTART + $BTNPAGEHEIGHT + ($iIB * $BTNPAGEHEIGHT), 35, $BTNPAGEHEIGHT, $BS_PUSHLIKE)
		$BTN_INDTRBLSHOOT[$iIB] = GUICtrlCreateCheckbox("a", 215, $BTNHOMESTART + $BTNPAGEHEIGHT + ($iIB * $BTNPAGEHEIGHT), 35, $BTNPAGEHEIGHT, $BS_PUSHLIKE)
		GUICtrlSetFont($BTN_INDTRBLSHOOT[$iIB], 12, 400, -1, "Webdings")
		$BTN_INDRUN[$iIB] = GUICtrlCreateButton("4", 250, $BTNHOMESTART + $BTNPAGEHEIGHT + ($iIB * $BTNPAGEHEIGHT), 30, $BTNPAGEHEIGHT)
		GUICtrlSetFont($BTN_INDRUN[$iIB], 12, 400, -1, "Webdings")

		GUICtrlSetOnEvent($BTN_INDPAGE[$iIB], "_SelectPage")
		GUICtrlSetOnEvent($BTN_INDPAGE2[$iIB], "_SelectPage")
		GUICtrlSetOnEvent($BTN_INDPAGE3[$iIB], "_SelectPage")
		GUICtrlSetOnEvent($BTN_INDTRBLSHOOT[$iIB], "_SelectPage")
	Next

	GUICtrlSetData($BTN_INDPAGE[0], Chr(32) & Chr(32) & "Malware")
	GUICtrlSetData($BTN_INDPAGE[1], Chr(32) & Chr(32) & "System")
	GUICtrlSetData($BTN_INDPAGE[2], Chr(32) & Chr(32) & "Desktop")
	GUICtrlSetData($BTN_INDPAGE[3], Chr(32) & Chr(32) & "Explorer")
	GUICtrlSetData($BTN_INDPAGE[4], Chr(32) & Chr(32) & "Internet (Network)")
	GUICtrlSetData($BTN_INDPAGE[5], Chr(32) & Chr(32) & "Hardware")
	GUICtrlSetData($BTN_INDPAGE[6], Chr(32) & Chr(32) & "Programs")
	GUICtrlSetData($BTN_INDPAGE[7], Chr(32) & Chr(32) & "Accociations")
	GUICtrlSetData($BTN_INDPAGE[8], Chr(32) & Chr(32) & "Security")
	GUICtrlSetData($BTN_INDPAGE[9], Chr(32) & Chr(32) & "Performance")

	GUICtrlSetFont($BTN_INDTRBLSHOOT[7], 8.5, 400, -1, "Verdana", $CLEARTYPE_QUALITY)
	GUICtrlSetData($BTN_INDTRBLSHOOT[7], 4)

	GUICtrlCreateIcon(@ScriptFullPath, 226, 15, 442, 16, 16)
	GUICtrlCreateIcon(@ScriptFullPath, 228, 35, 442, 16, 16)
	GUICtrlCreateIcon(@ScriptFullPath, 230, 55, 442, 16, 16)

	GUICtrlCreateLabel("00:00:00", 177, 442, 100, 16, $SS_CENTER)
	;~ GUICtrlSetColor(-1, 0xFFFFFF)
	;~ GUICtrlSetBkColor(-1, 0x000000)

	GUICtrlCreateLabel("", 11, 461, 267, 1)
	GUICtrlSetBkColor(-1, 0xFFFFFF)
	GUICtrlCreateLabel("", 10, 462, 269, 1)
	GUICtrlSetBkColor(-1, 0xC0C0C0)

	GUICtrlCreateTab(290, -25, 525, 495, $TCS_BUTTONS)

	$PAGE_HOME[0] = GUICtrlCreateTabItem("Desktop")
	GUICtrlCreateGroup("Desktop", 305, 10, 430, 405)
	GUICtrlCreateLabel(	"Before you start, remember never attempt to fix something that is not broken. " & _
						"Read the supplied information about each repair option and " & _
						"make sure your computer is showing the specific symptoms before applying a fix, " & _
						"otherwise you could mess things up even more.", 320, 40, 380, 70)
	GUICtrlCreateGroup("", -99, -99, 1, 1)
	GUICtrlCreateTabItem("") ; end tabitem definition

	$PAGE_HOME[1] = GUICtrlCreateTabItem("Home 1")
	GUICtrlCreateGroup("Before you Start", 305, 10, 430, 405)
	GUICtrlSetFont(-1, 10)

	GUICtrlCreateGroup("", -99, -99, 1, 1)
	GUICtrlCreateTabItem("") ; end tabitem definition

	$PAGE_HOME[2] = GUICtrlCreateTabItem("Home 2")
	GUICtrlCreateTabItem("") ; end tabitem definition

	$PAGE_HOME[3] = GUICtrlCreateTabItem("Home 3")
	GUICtrlCreateTabItem("") ; end tabitem definition

	$PAGE_HOME[4] = GUICtrlCreateTabItem("Home 4")
	GUICtrlCreateTabItem("") ; end tabitem definition

	$PAGE_HOME[5] = GUICtrlCreateTabItem("Quick Repair")
	GUICtrlCreateTabItem("") ; end tabitem definition

	$PAGE_SYSTEM[0] = GUICtrlCreateTabItem("System 1")
	GUICtrlCreateGroup("System Repair", 305, 10, 430, 405)
	GUICtrlSetFont(-1, 10)
	$BTN_SYSTROUBLESHOOT = GUICtrlCreateButton("Troubleshooting", 565, 35, 150, 30)
	GUICtrlCreateGroup("", -99, -99, 1, 1)
	GUICtrlCreateTabItem("")

	GUICtrlSetOnEvent($BTN_SYSTROUBLESHOOT, "_SelectPage")

	$PAGE_SYSTEM[3] = GUICtrlCreateTabItem("System Troubleshooting")
	GUICtrlCreateGroup("System Troubleshooting", 305, 10, 430, 405)
	GUICtrlSetFont(-1, 10)
	GUICtrlCreateGroup("Run System File Checker", 320, 50, 400, 140)
	GUICtrlCreateIcon(@ScriptFullPath, 232, 335, 85, 32, 32, -1, $WS_EX_TRANSPARENT)
	GUICtrlCreateLabel("Scan your computer using System File Checker (SFC). " & _
	"This can resolve many issues. Click on the Scan System Files " & _
	"button below and reboot your computer when asked.", 390, 83, 310, 55)
	GUICtrlCreateButton("Scan System Files", 550, 140, 150, 30)
	GUICtrlCreateGroup("", -99, -99, 1, 1)
	GUICtrlCreateGroup("", -99, -99, 1, 1)
	GUICtrlCreateTabItem("")

	$PAGE_MALWARE[0] = GUICtrlCreateTabItem("Malware 1")
	GUICtrlCreateGroup("Malware", 305, 10, 430, 405)
	GUICtrlSetFont(-1, 10)
	$BTN_MALTROUBLESHOOT = GUICtrlCreateButton("Troubleshooting", 565, 35, 150, 30)

	For $iMal = 0 To $COUNT_MALWARE1 - 1
		$ICON_MALWARE1[$iMal] = GUICtrlCreateIcon(@ScriptFullPath, 251 + $iMal, 320, 85 + ($iMal * $LINESPACING), 16, 16)
		$CHK_MALWARE1[$iMal] = GUICtrlCreateCheckbox(" Repair something here!", 345, 85 + ($iMal * $LINESPACING), 330, 16)
		$BTNHLP_MALWARE1[$iMal] = GUICtrlCreateIcon(@ScriptFullPath, 203, 680, 85 + ($iMal * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNHLP_MALWARE1[$iMal], 0)
		$BTNGO_MALWARE1[$iMal] = GUICtrlCreateIcon(@ScriptFullPath, 201, 700, 85 + ($iMal * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNGO_MALWARE1[$iMal], 0)
		$PRGTOP_MALWARE1[$iMal] = 98 + ($iMal * $LINESPACING)
		$LINE_MALWARE1[$iMal] = GUICtrlCreateLabel("", 365, $PRGTOP_MALWARE1[$iMal], 310, 1)
		GUICtrlSetBkColor($LINE_MALWARE1[$iMal], 0xD9D9D9)
		$PROGRESS_MALWARE1[$iMal] = GUICtrlCreateLabel("", 365, $PRGTOP_MALWARE1[$iMal], 1, 1)
		GUICtrlSetBkColor($PROGRESS_MALWARE1[$iMal], 0x68CEFA)
		GUICtrlSetState($PROGRESS_MALWARE1[$iMal], $GUI_HIDE)

		GUICtrlSetOnEvent($BTNGO_MALWARE1[$iMal], "_RunRepairOption")
	Next

	GUICtrlCreateGroup("", -99, -99, 1, 1)

	GUICtrlSetData($CHK_MALWARE1[0], " Remove Common Malware and Traces")

	$BTN_MALWAREBACK1 = GUICtrlCreateButton("Back", 305, 420, 100, 30)
	$BTN_MALWARENEXT1 = GUICtrlCreateButton("Next", 405, 420, 100, 30)

	GuiCtrlSetOnEvent($BTN_MALWAREBACK1, "_SelectPage")
	GuiCtrlSetOnEvent($BTN_MALWARENEXT1, "_SelectPage")

	GUICtrlCreateTabItem("") ; end tabitem definition

	;------------------------------------------------------------------------------------------------------------------------
	;~ Desktop Page
	;------------------------------------------------------------------------------------------------------------------------
	$PAGE_DESKTOP[0] = GUICtrlCreateTabItem("Desktop 1")

	GUICtrlCreateGroup("Desktop", 305, 10, 430, 405)
	GUICtrlSetFont(-1, 10)
	$BTN_DESKTOPTROUBLESHOOT = GUICtrlCreateButton("Troubleshooting", 565, 35, 150, 30)
	For $iDesk1 = 0 To $COUNT_DESKTOP1 - 1
		$ICON_DESKTOP1[$iDesk1] = GUICtrlCreateIcon(@ScriptFullPath, 281 + $iDesk1, 320, 85 + ($iDesk1 * $LINESPACING), 16, 16)
		$CHK_DESKTOP1[$iDesk1] = GUICtrlCreateCheckbox(" Repair something here!", 345, 85 + ($iDesk1 * $LINESPACING), 330, 16)
		$BTNHLP_DESKTOP1[$iDesk1] = GUICtrlCreateIcon(@ScriptFullPath, 203, 680, 85 + ($iDesk1 * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNHLP_DESKTOP1[$iDesk1], 0)
		$BTNGO_DESKTOP1[$iDesk1] = GUICtrlCreateIcon(@ScriptFullPath, 201, 700, 85 + ($iDesk1 * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNGO_DESKTOP1[$iDesk1], 0)
		$PRGTOP_DESKTOP1[$iDesk1] = 103 + ($iDesk1 * $LINESPACING)
		$LINE_DESKTOP1[$iDesk1] = GUICtrlCreateLabel("", 365, $PRGTOP_DESKTOP1[$iDesk1], 310, 1)
		GUICtrlSetBkColor($LINE_DESKTOP1[$iDesk1], 0xD9D9D9)
		$PROGRESS_DESKTOP1[$iDesk1] = GUICtrlCreateLabel("", 365, $PRGTOP_DESKTOP1[$iDesk1], 1, 1)
		GUICtrlSetBkColor($PROGRESS_DESKTOP1[$iDesk1], 0x68CEFA)
		GUICtrlSetState($PROGRESS_DESKTOP1[$iDesk1], $GUI_HIDE)

		GUICtrlSetOnEvent($BTNGO_DESKTOP1[$iDesk1], "_RunRepairOption")
	Next
	GUICtrlCreateGroup("", -99, -99, 1, 1)

	GUICtrlSetData($CHK_DESKTOP1[0], " Repair Windows Aero")
	GUICtrlSetData($CHK_DESKTOP1[1], " Increase Icon Cache DB size to 4MB")
	GUICtrlSetData($CHK_DESKTOP1[2], " Rebuild the Icon Cache")
	GUICtrlSetData($CHK_DESKTOP1[3], " Repair corrupted Recycle Bin")
	GUICtrlSetData($CHK_DESKTOP1[4], " Restore missing Recycle Bin")
	GUICtrlSetData($CHK_DESKTOP1[5], " Recycle Bin does not refresh (Restore Icons)")
	GUICtrlSetData($CHK_DESKTOP1[6], " " & _ReturnRemoveDeleteCaption())
	GUICtrlSetData($CHK_DESKTOP1[7], " Restore Windows Sidebar")

	$BTN_DESKTOPBACK1 = GUICtrlCreateButton("Back", 305, 420, 100, 30)
	$BTN_DESKTOPNEXT1 = GUICtrlCreateButton("Next", 405, 420, 100, 30)

	GuiCtrlSetOnEvent($BTN_DESKTOPBACK1, "_SelectPage")
	GuiCtrlSetOnEvent($BTN_DESKTOPNEXT1, "_SelectPage")

	GUICtrlCreateTabItem("") ; end tabitem definition
	;------------------------------------------------------------------------------------------------------------------------

	$PAGE_ASSOCIATIONS[0] = GUICtrlCreateTabItem("Associations 1")
	GUICtrlSetBkColor(-1, 0xCCCCCC)

	GUICtrlCreateGroup("Associations 1", 305, 10, 430, 405)
	For $iAcc = 0 To $COUNT_ASSOCIATIONS1 - 1
		$ICON_ASSOCIATIONS1[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 276 + $iAcc, 320, 40 + ($iAcc * $LINESPACING), 16, 16)
		$CHK_ASSOCIATIONS1[$iAcc] = GUICtrlCreateCheckbox(" Repair something here!", 345, 40 + ($iAcc * $LINESPACING), 330, 16)
		$BTNHLP_ASSOCIATIONS1[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 203, 680, 40 + ($iAcc * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNHLP_ASSOCIATIONS1[$iAcc], 0)
		$BTNGO_ASSOCIATIONS1[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 201, 700, 40 + ($iAcc * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNGO_ASSOCIATIONS1[$iAcc], 0)
		$PRGTOP_ASSOCIATIONS1[$iAcc] = 58 + ($iAcc * $LINESPACING)
		$LINE_ASSOCIATIONS1[$iAcc] = GUICtrlCreateLabel("", 365, $PRGTOP_ASSOCIATIONS1[$iAcc], 310, 1)
		GUICtrlSetBkColor($LINE_ASSOCIATIONS1[$iAcc], 0xD9D9D9)
		$PROGRESS_ASSOCIATIONS1[$iAcc] = GUICtrlCreateLabel("", 365, $PRGTOP_ASSOCIATIONS1[$iAcc], 1, 1)
		GUICtrlSetBkColor($PROGRESS_ASSOCIATIONS1[$iAcc], 0x68CEFA)
		GUICtrlSetState($PROGRESS_ASSOCIATIONS1[$iAcc], $GUI_HIDE)

		GUICtrlSetOnEvent($BTNGO_ASSOCIATIONS1[$iAcc], "_RunRepairOption")

	Next
	GUICtrlCreateGroup("", -99, -99, 1, 1)

	GUICtrlSetData($CHK_ASSOCIATIONS1[0], " Executable Files (.exe .com)")

;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[0], " Executable Files (.exe, .bat, .cmd, .com)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[1], " Dynamic Link Library (.dll)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[2], " Shortcut Link File (.lnk, .url)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[3], " Registry File (.reg)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[4], " Screen Saver File (.scr)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[5], " Control Panel Item (.cpl)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[6], " Audio CD Protocol Associations")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[7], " Drive Protocol Associations")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[8], " Directory Protocol Associations")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[9], " Folder Protocol Associations")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[10], " Windows Search Protocol")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[11], " Library Folder")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[12], " Initialization or Configuration File (.ini)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[13], " Setup Information File (.inf)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[14], " Font Files (.otf, .ttf)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[15], " Rich Text Document Files (.rtf)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[16], " Text Document (.txt)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS1[17], " Compressed Folders (.zip)")

	GUICtrlCreateTabItem("") ; end tabitem definition



	$PAGE_ASSOCIATIONS[1] = GUICtrlCreateTabItem("Accociations 2")
	GUICtrlSetBkColor(-1, 0xCCCCCC)

	GUICtrlCreateGroup("Accociations 2", 305, 10, 430, 405)
	For $iAcc = 0 To $COUNT_ASSOCIATIONS2 - 1
		$ICON_ASSOCIATIONS2[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 251 + $iAcc, 320, 40 + ($iAcc * $LINESPACING), 16, 16)
		$CHK_ASSOCIATIONS2[$iAcc] = GUICtrlCreateCheckbox(" Repair something here!", 345, 40 + ($iAcc * $LINESPACING), 330, 16)
		$BTNHLP_ASSOCIATIONS2[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 203, 680, 40 + ($iAcc * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNHLP_ASSOCIATIONS2[$iAcc], 0)
		$BTNGO_ASSOCIATIONS2[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 201, 700, 40 + ($iAcc * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNGO_ASSOCIATIONS2[$iAcc], 0)
		$PRGTOP_ASSOCIATIONS2[$iAcc] = 58 + ($iAcc * $LINESPACING)
		$LINE_ASSOCIATIONS2[$iAcc] = GUICtrlCreateLabel("", 365, $PRGTOP_ASSOCIATIONS2[$iAcc], 310, 1)
		GUICtrlSetBkColor($LINE_ASSOCIATIONS2[$iAcc], 0xD9D9D9)
		$PROGRESS_ASSOCIATIONS2[$iAcc] = GUICtrlCreateLabel("", 365, $PRGTOP_ASSOCIATIONS2[$iAcc], 1, 1)
		GUICtrlSetBkColor($PROGRESS_ASSOCIATIONS2[$iAcc], 0x68CEFA)
		GUICtrlSetState($PROGRESS_ASSOCIATIONS2[$iAcc], $GUI_HIDE)
	Next
	GUICtrlCreateGroup("", -99, -99, 1, 1)

;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[0], " Unknown File Type")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[1], " Remove Association with Blank File Extension")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[2], " Cabinet File (.cab)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[3], " CD or DVD Image Files (.img, .iso)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[4], " Mirosoft Common Console Document (.msc)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[5], " Microsoft Windows Installer Files (.msi, .msp)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[6], " Windows Contacts (.contact)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[7], " Security Certificate Files (.cer, .crt, .der)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[8], " Windows Theme Files (.theme, .themepack)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[9], " Portable Document Format (.pdf)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[10], " XML Paper Specification Document (.xps)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[11], " Bitmap Image File (.bmp)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[12], " Image Files (.jpe, .jpeg, .jpg, .tif, .tiff)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[13], " Graphics Interchange Format (.gif)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[14], " Portable Network Graphics File (.png)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[15], " Icon Files (.ani, .cur, .ico)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[16], " Microsoft Compiled Help File (.chm)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS2[17], " Temporary File (.tmp)")
	GUICtrlCreateTabItem("") ; end tabitem definition

	$PAGE_ASSOCIATIONS[2] = GUICtrlCreateTabItem("Accociations 3")

	GUICtrlCreateGroup("Accociations 3", 305, 10, 430, 405)
	For $iAcc = 0 To $COUNT_ASSOCIATIONS3 - 1
		$ICON_ASSOCIATIONS3[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 251 + $iAcc, 320, 40 + ($iAcc * $LINESPACING), 16, 16)
		$CHK_ASSOCIATIONS3[$iAcc] = GUICtrlCreateCheckbox(" Repair something here!", 345, 40 + ($iAcc * $LINESPACING), 330, 16)
		$BTNHLP_ASSOCIATIONS3[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 203, 680, 40 + ($iAcc * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNHLP_ASSOCIATIONS3[$iAcc], 0)
		$BTNGO_ASSOCIATIONS3[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 201, 700, 40 + ($iAcc * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNGO_ASSOCIATIONS3[$iAcc], 0)
		$PRGTOP_ASSOCIATIONS3[$iAcc] = 58 + ($iAcc * $LINESPACING)
		$LINE_ASSOCIATIONS3[$iAcc] = GUICtrlCreateLabel("", 365, $PRGTOP_ASSOCIATIONS3[$iAcc], 310, 1)
		GUICtrlSetBkColor($LINE_ASSOCIATIONS3[$iAcc], 0xD9D9D9)
		$PROGRESS_ASSOCIATIONS3[$iAcc] = GUICtrlCreateLabel("", 365, $PRGTOP_ASSOCIATIONS3[$iAcc], 1, 1)
		GUICtrlSetBkColor($PROGRESS_ASSOCIATIONS3[$iAcc], 0x68CEFA)
		GUICtrlSetState($PROGRESS_ASSOCIATIONS3[$iAcc], $GUI_HIDE)
	Next
	GUICtrlCreateGroup("", -99, -99, 1, 1)

;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[0], " Audio Files (.aac, .asf, .m4a, .mp3, .mpa, .wav)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[1], " Advanced Stream Redirector Play List File (.asx)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[2], " MP3 Playlist File (.m3u)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[3], " Video Files (.avi, .mp4, .mpe, .mpeg, .mpg, .mov)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[4], " MPEG-4 File Extension (.m4v)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[5], " Matroska Multimedia Container File (.mkv)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[6], " Windows Media Audio File (.wma, .wmv)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[7], " Movie Data File from a DVD Disc (.vob)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[8], " HD/BD Video Recording (.m2t, .m2ts)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[9], " MadTracker 2 Sample File (.mts)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[10], " Microsoft Recorded TV Show File (.dvr-ms)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[11], " Cell Phone Media Files (.3gp, .3gpp)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[12], " Help Files (.hlp)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[13], " HTML Documents (.htm, .html, .mhtml, .xml, .xsl)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[14], " HTML Application (.hta)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[15], " Cascading Style Sheet Document (.css)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[16], " ASP.NET Source File (.aspx)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS3[17], " Script Files (.js, .jse, .vbs, .wsf)")
	GUICtrlCreateTabItem("") ; end tabitem definition

	$PAGE_ASSOCIATIONS[3] = GUICtrlCreateTabItem("Troubleshooting")

	GUICtrlCreateGroup("Accociations 3", 305, 10, 430, 405)
	For $iAcc = 0 To $COUNT_ASSOCIATIONS4 - 1
		$ICON_ASSOCIATIONS4[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 251 + $iAcc, 320, 40 + ($iAcc * $LINESPACING), 16, 16)
		$CHK_ASSOCIATIONS4[$iAcc] = GUICtrlCreateCheckbox(" Repair something here!", 345, 40 + ($iAcc * $LINESPACING), 330, 16)
		$BTNHLP_ASSOCIATIONS4[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 203, 680, 40 + ($iAcc * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNHLP_ASSOCIATIONS4[$iAcc], 0)
		$BTNGO_ASSOCIATIONS4[$iAcc] = GUICtrlCreateIcon(@ScriptFullPath, 201, 700, 40 + ($iAcc * $LINESPACING), 16, 16)
		GUICtrlSetCursor($BTNGO_ASSOCIATIONS4[$iAcc], 0)
		$PRGTOP_ASSOCIATIONS4[$iAcc] = 58 + ($iAcc * $LINESPACING)
		$LINE_ASSOCIATIONS4[$iAcc] = GUICtrlCreateLabel("", 365, $PRGTOP_ASSOCIATIONS4[$iAcc], 310, 1)
		GUICtrlSetBkColor($LINE_ASSOCIATIONS4[$iAcc], 0xD9D9D9)
		$PROGRESS_ASSOCIATIONS4[$iAcc] = GUICtrlCreateLabel("", 365, $PRGTOP_ASSOCIATIONS4[$iAcc], 1, 1)
		GUICtrlSetBkColor($PROGRESS_ASSOCIATIONS4[$iAcc], 0x68CEFA)
		GUICtrlSetState($PROGRESS_ASSOCIATIONS4[$iAcc], $GUI_HIDE)
	Next
	GUICtrlCreateGroup("", -99, -99, 1, 1)

;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[0], " Microsoft Windows PowerShell File (.ps1)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[1], " BASIC Source Code File (.bas)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[2], " C++ Source Code File (.cpp, .h)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[3], " Data Base File (.db)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[4], " Generic Data File (.dat)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[5], " Binary File (.bin)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[6], " Dictionary File (.dic)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[7], " Journal Document File (.jnt)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[8], " System Information File (.nfo)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[9], " File Information (.manifest)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[10], " Mail Service (.mapimail)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[11], " Dial-Up Phonebook File (.pbk)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[12], " Package Protocol (.package)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[13], " Object File (.obj)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[14], " Log File (.log)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[15], " Backup File (.bak)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[16], " Archive Files (.gz, .tar)")
;~ 	GUICtrlSetData($CHK_ASSOCIATIONS4[17], " AI File (.ai)")
	GUICtrlCreateTabItem("") ; end tabitem definition

	$BTNGO_ALL = GUICtrlCreateButton("Go!", 585, 420, 150, 40)
	GUICtrlSetFont($BTNGO_ALL, 12)

	$LST_STATUS = GUICtrlCreateList("", 10, 515, 725, 130, BitOR($LBS_STANDARD, $LBS_USETABSTOPS, $LBS_NOTIFY, $WS_HSCROLL, $WS_VSCROLL))

	$BTN_GUIEXTEND = GUICtrlCreateCheckbox(6, 705, 470, 30, 28, $BS_PUSHLIKE)
	GUICtrlSetFont($BTN_GUIEXTEND , 10, 400, 0, "Webdings")
	GUICtrlSetTip($BTN_GUIEXTEND , "Show Status")

	GUICtrlSetOnEvent($BTN_GUIEXTEND, "_GUIExtender")


	GUISetState(@SW_SHOW, $GUI_COREHANDLE)
	GUISetOnEvent($GUI_EVENT_CLOSE, "_CloseWindowsRepair", $GUI_COREHANDLE)

	_SplashUpdate("Loading Complete Windows Repair", 100)

	AdlibRegister("_GatherDisplayStats", 1000)
	_GatherDisplayStats()

	While 1
		Sleep(125)
	WEnd

EndFunc


Func _GatherDisplayStats()

	Local $memStats = MemGetStats()
	Local $pageUsPerc = Round((($memStats[3] - $memStats[4]) / $memStats[3]) * 100)
;~ 	Local $CurTime = _Date_Time_GetLocalTime()

;~ 	GuiCtrlSetData($DoorsTime, _Date_Time_SystemTimeToTimeStr($CurTime))

	_GetSystemTime($END_IDLE, $END_KERNEL, $END_USER)
	_CPUUsageCalc()
	_GetSystemTime($START_IDLE, $START_KERNEL, $START_USER)

	If $memStats[0] <> $MEM_BUFFER1 Then
		_DrawStatusSizeFromPercentage($BAR_MEMORY_USAGE, $memStats[0], 100, 10, 100, 8)
		GuiCtrlSetData($LBL_MEMORY_USAGE, $memStats[0] & " %")
		$MEM_BUFFER1 = $memStats[0]
	EndIf

	If $pageUsPerc <> $MEM_BUFFER2 Then
		_DrawStatusSizeFromPercentage($BAR_PAGE_USAGE, $pageUsPerc, 100, 20, 100, 8)
		GuiCtrlSetData($LBL_PAGE_USAGE, $PageUsPerc & " %")
		$MEM_BUFFER2 = $pageUsPerc
	EndIf


EndFunc ;~ ==> _GatherDisplayStats()


Func _GetSystemTime(ByRef $sIdle, ByRef $sKernel, ByRef $sUser)

	DllCall("kernel32.dll", "int", "GetSystemTimes", "ptr", DllStructGetPtr($IDLETIME), _
            "ptr", DllStructGetPtr($KERNELTIME), _
            "ptr", DllStructGetPtr($USERTIME))

    $sIdle = DllStructGetData($IDLETIME, 1)
    $sKernel = DllStructGetData($KERNELTIME, 1)
    $sUser = DllStructGetData($USERTIME, 1)

EndFunc   ;==>_GetSysTime


Func _CPUUsageCalc()

	Local $iSystemTime, $iTotal, $iCalcIdle, $iCalcKernel, $iCalcUser

	$iCalcIdle   = ($END_IDLE - $START_IDLE)
	$iCalcKernel = ($END_KERNEL - $START_KERNEL)
	$iCalcUser   = ($END_USER - $START_USER)

	$iSystemTime = ($iCalcKernel + $iCalcUser)
	$iTotal = Int(($iSystemTime - $iCalcIdle) * (100 / $iSystemTime))

	If $iTotal >= 0 And $iTotal < 100 Then
		_DrawStatusSizeFromPercentage($BAR_PROCESSOR_USAGE, $iTotal, 100, 33, 100, 12)
		GUICtrlSetData($LBL_PROCESSOR_USAGE, $iTotal & " %")
	EndIf

EndFunc


Func _GUIExtender()
	If IsArray($GUI_COORDS) Then
		If $GUI_RETRACTED = False Then
			_GUIRetract()
		ElseIf $GUI_RETRACTED = True Then
			_GUIExpand(150)
		EndIf
	EndIf
EndFunc


Func _GUIRetract()

	WinMove($GUI_COREHANDLE, "", Default, Default, $GUI_COORDS[2], $GUI_COORDS[3])
	GUICtrlSetData($BTN_GUIEXTEND, 6)
	GUICtrlSetState($BTN_GUIEXTEND, $GUI_UNCHECKED)
	GUICtrlSetTip($BTN_GUIEXTEND, "Show Status")
	$GUI_RETRACTED = True

EndFunc


Func _GUIExpand($iSize)

	WinMove($GUI_COREHANDLE, "", Default, Default, $GUI_COORDS[2], $GUI_COORDS[3] + $iSize)
	GUICtrlSetData($BTN_GUIEXTEND, 5)
	GUICtrlSetState($BTN_GUIEXTEND, $GUI_CHECKED)
	GUICtrlSetTip($BTN_GUIEXTEND, "Hide Status")
	$GUI_RETRACTED = False

EndFunc


Func _SelectPage()

	Switch @GUI_CtrlId
		Case $BTN_HOME[0]
			_ShowPageFromIndex(1)
		Case $BTN_HOME[1]
			_ShowPageFromIndex(2)
		Case $BTN_HOME[2]
			_ShowPageFromIndex(3)
		Case $BTN_HOME[3]
			_ShowPageFromIndex(4)
		Case $BTN_HOME[4]
			_ShowPageFromIndex(5)
		Case $BTN_HOME[5]
			_ShowPageFromIndex(6)
		Case $BTN_INDPAGE[0]
			_ShowPageFromIndex(7)
		Case $BTN_INDPAGE[1]
			_ShowPageFromIndex(8)
		Case $BTN_INDPAGE[2]
			_ShowPageFromIndex(9)
		Case $BTN_INDPAGE[3]
			_ShowPageFromIndex(10)
		Case $BTN_INDPAGE[4]
			_ShowPageFromIndex(11)
		Case $BTN_INDPAGE[5]
			_ShowPageFromIndex(12)
		Case $BTN_INDPAGE[6]
			_ShowPageFromIndex(13)
		Case $BTN_INDPAGE[7]
			_ShowPageFromIndex(14)
		Case $BTN_INDPAGE[8]
			_ShowPageFromIndex(15)
		Case $BTN_INDPAGE[9]
			_ShowPageFromIndex(16)
		Case $BTN_INDPAGE2[0]
			_ShowPageFromIndex(17)
		Case $BTN_INDPAGE2[1]
			_ShowPageFromIndex(18)
		Case $BTN_INDPAGE2[2]
			_ShowPageFromIndex(19)
		Case $BTN_INDPAGE2[3]
			_ShowPageFromIndex(20)
		Case $BTN_INDPAGE2[4]
			_ShowPageFromIndex(21)
		Case $BTN_INDPAGE2[5]
			_ShowPageFromIndex(22)
		Case $BTN_INDPAGE2[6]
			_ShowPageFromIndex(23)
		Case $BTN_INDPAGE2[7]
			_ShowPageFromIndex(24)
		Case $BTN_INDPAGE2[8]
			_ShowPageFromIndex(25)
		Case $BTN_INDPAGE2[9]
			_ShowPageFromIndex(26)
		Case $BTN_INDPAGE3[0]
			_ShowPageFromIndex(27)
		Case $BTN_INDPAGE3[1]
			_ShowPageFromIndex(28)
		Case $BTN_INDPAGE3[2]
			_ShowPageFromIndex(29)
		Case $BTN_INDPAGE3[3]
			_ShowPageFromIndex(30)
		Case $BTN_INDPAGE3[4]
			_ShowPageFromIndex(31)
		Case $BTN_INDPAGE3[5]
			_ShowPageFromIndex(32)
		Case $BTN_INDPAGE3[6]
			_ShowPageFromIndex(33)
		Case $BTN_INDPAGE3[7]
			_ShowPageFromIndex(34)
		Case $BTN_INDPAGE3[8]
			_ShowPageFromIndex(35)
		Case $BTN_INDPAGE3[9]
			_ShowPageFromIndex(36)
		Case $BTN_INDTRBLSHOOT[0], $BTN_MALTROUBLESHOOT
			_ShowPageFromIndex(37)
		Case $BTN_INDTRBLSHOOT[1], $BTN_SYSTROUBLESHOOT
			_ShowPageFromIndex(38)
		Case $BTN_INDTRBLSHOOT[2]
			_ShowPageFromIndex(39)
		Case $BTN_INDTRBLSHOOT[3]
			_ShowPageFromIndex(40)
		Case $BTN_INDTRBLSHOOT[4]
			_ShowPageFromIndex(41)
		Case $BTN_INDTRBLSHOOT[5]
			_ShowPageFromIndex(42)
		Case $BTN_INDTRBLSHOOT[6]
			_ShowPageFromIndex(43)
		Case $BTN_INDTRBLSHOOT[7]
			_ShowPageFromIndex(44)
		Case $BTN_INDTRBLSHOOT[8]
			_ShowPageFromIndex(45)
		Case $BTN_INDTRBLSHOOT[9]
			_ShowPageFromIndex(46)

	EndSwitch


EndFunc


Func _ShowPageFromIndex($pageIndex)

	For $iHB = 0 To UBound($BTN_HOME) - 1
		GUICtrlSetState($BTN_HOME[$iHB], $GUI_UNCHECKED)
	Next

	For $iIB = 0 To UBound($BTN_INDPAGE) - 1
		GUICtrlSetState($BTN_INDPAGE[$iIB], $GUI_UNCHECKED)
		GUICtrlSetState($BTN_INDPAGE2[$iIB], $GUI_UNCHECKED)
		GUICtrlSetState($BTN_INDPAGE3[$iIB], $GUI_UNCHECKED)
		GUICtrlSetState($BTN_INDTRBLSHOOT[$iIB], $GUI_UNCHECKED)
	Next

	Switch $pageIndex
		Case 1
			GUICtrlSetState($BTN_HOME[0], $GUI_CHECKED)
			GUICtrlSetState($PAGE_HOME[0], $GUI_SHOW)
		Case 2
			GUICtrlSetState($BTN_HOME[1], $GUI_CHECKED)
			GUICtrlSetState($PAGE_HOME[1], $GUI_SHOW)
		Case 3
			GUICtrlSetState($BTN_HOME[2], $GUI_CHECKED)
		Case 4
			GUICtrlSetState($BTN_HOME[3], $GUI_CHECKED)
		Case 5
			GUICtrlSetState($BTN_HOME[4], $GUI_CHECKED)
		Case 6
			GUICtrlSetState($BTN_HOME[5], $GUI_CHECKED)
		Case 7
			GUICtrlSetState($BTN_INDPAGE[0], $GUI_CHECKED)
			GUICtrlSetState($PAGE_MALWARE[0], $GUI_SHOW)
		Case 8
			GUICtrlSetState($BTN_INDPAGE[1], $GUI_CHECKED)
			GUICtrlSetState($PAGE_SYSTEM[0], $GUI_SHOW)
		Case 9
			GUICtrlSetState($BTN_INDPAGE[2], $GUI_CHECKED)
			GUICtrlSetState($PAGE_DESKTOP[0], $GUI_SHOW)
		Case 10
			GUICtrlSetState($BTN_INDPAGE[3], $GUI_CHECKED)
		Case 11
			GUICtrlSetState($BTN_INDPAGE[4], $GUI_CHECKED)
		Case 12
			GUICtrlSetState($BTN_INDPAGE[5], $GUI_CHECKED)
		Case 13
			GUICtrlSetState($BTN_INDPAGE[6], $GUI_CHECKED)
		Case 14
			GUICtrlSetState($BTN_INDPAGE[7], $GUI_CHECKED)
			GUICtrlSetState($PAGE_ASSOCIATIONS[0], $GUI_SHOW)
		Case 15
			GUICtrlSetState($BTN_INDPAGE[8], $GUI_CHECKED)
		Case 16
			GUICtrlSetState($BTN_INDPAGE[9], $GUI_CHECKED)
		Case 17
			GUICtrlSetState($BTN_INDPAGE2[0], $GUI_CHECKED)
		Case 18
			GUICtrlSetState($BTN_INDPAGE2[1], $GUI_CHECKED)
		Case 19
			GUICtrlSetState($BTN_INDPAGE2[2], $GUI_CHECKED)
		Case 20
			GUICtrlSetState($BTN_INDPAGE2[3], $GUI_CHECKED)
		Case 21
			GUICtrlSetState($BTN_INDPAGE2[4], $GUI_CHECKED)
		Case 22
			GUICtrlSetState($BTN_INDPAGE2[5], $GUI_CHECKED)
		Case 23
			GUICtrlSetState($BTN_INDPAGE2[6], $GUI_CHECKED)
		Case 24
			GUICtrlSetState($BTN_INDPAGE2[7], $GUI_CHECKED)
			GUICtrlSetState($PAGE_ASSOCIATIONS[1], $GUI_SHOW)
		Case 25
			GUICtrlSetState($BTN_INDPAGE2[8], $GUI_CHECKED)
		Case 26
			GUICtrlSetState($BTN_INDPAGE2[9], $GUI_CHECKED)
		Case 27
			GUICtrlSetState($BTN_INDPAGE3[0], $GUI_CHECKED)
		Case 28
			GUICtrlSetState($BTN_INDPAGE3[1], $GUI_CHECKED)
		Case 29
			GUICtrlSetState($BTN_INDPAGE3[2], $GUI_CHECKED)
		Case 30
			GUICtrlSetState($BTN_INDPAGE3[3], $GUI_CHECKED)
		Case 31
			GUICtrlSetState($BTN_INDPAGE3[4], $GUI_CHECKED)
		Case 32
			GUICtrlSetState($BTN_INDPAGE3[5], $GUI_CHECKED)
		Case 33
			GUICtrlSetState($BTN_INDPAGE3[6], $GUI_CHECKED)
		Case 34
			GUICtrlSetState($BTN_INDPAGE3[7], $GUI_CHECKED)
			GUICtrlSetState($PAGE_ASSOCIATIONS[2], $GUI_SHOW)
		Case 35
			GUICtrlSetState($BTN_INDPAGE3[8], $GUI_CHECKED)
		Case 36
			GUICtrlSetState($BTN_INDPAGE3[9], $GUI_CHECKED)
		Case 37
			GUICtrlSetState($BTN_INDTRBLSHOOT[0], $GUI_CHECKED)
		Case 38
			GUICtrlSetState($BTN_INDTRBLSHOOT[1], $GUI_CHECKED)
			GUICtrlSetState($PAGE_SYSTEM[3], $GUI_SHOW)
		Case 39
			GUICtrlSetState($BTN_INDTRBLSHOOT[2], $GUI_CHECKED)
		Case 40
			GUICtrlSetState($BTN_INDTRBLSHOOT[3], $GUI_CHECKED)
		Case 41
			GUICtrlSetState($BTN_INDTRBLSHOOT[4], $GUI_CHECKED)
		Case 42
			GUICtrlSetState($BTN_INDTRBLSHOOT[5], $GUI_CHECKED)
		Case 43
			GUICtrlSetState($BTN_INDTRBLSHOOT[6], $GUI_CHECKED)
		Case 44
			GUICtrlSetState($BTN_INDTRBLSHOOT[7], $GUI_CHECKED)
			GUICtrlSetState($PAGE_ASSOCIATIONS[3], $GUI_SHOW)
		Case 45
			GUICtrlSetState($BTN_INDTRBLSHOOT[8], $GUI_CHECKED)
		Case 46
			GUICtrlSetState($BTN_INDTRBLSHOOT[9], $GUI_CHECKED)
	EndSwitch

EndFunc


Func _OpenBIOSCodes()

	_StartLogging("Starting BIOS Beep Codes Viewer")
	ShellExecute($EXE_BIOSCODES)
	_EndLogging()

EndFunc


Func _OpenQuickErase()

	_StartLogging("Starting Quick Erase")
	ShellExecute($EXE_QUICKERASE)
	_EndLogging()

EndFunc


Func _OpenIndicators()

	_StartLogging("Starting Indicators")
	ShellExecute($EXE_INDICATORS)
	_EndLogging()

EndFunc


Func _RunSystemFileScanner()
	ShellExecute("SFC", "/scannow", @SystemDir, "", @SW_SHOW)
EndFunc


Func _RunSystemRestore()
	ShellExecute("systempropertiesprotection")
EndFunc


Func _RunRepairOption()

	Switch @GUI_CtrlId
		Case $BTNGO_ASSOCIATIONS1[0]
			_RepairAssociations(".exe")
	EndSwitch

EndFunc


Func _RepairAssociations($sFileExt)

	Switch $sFileExt
		Case ".exe", ".com"
			_BeginProcess($ICON_ASSOCIATIONS1[0], $CHK_ASSOCIATIONS1[0])
			_EndProcess($ICON_ASSOCIATIONS1[0], $CHK_ASSOCIATIONS1[0], 251)
	EndSwitch

EndFunc


Func _BeginProcess($CtrlIcon, $CtrlCheckbox, $isDownload = false)

	GUICtrlSetImage($CtrlIcon, $ANI_PROCESS)
	Sleep(3000)
	GUICtrlSetState($CtrlCheckbox, $GUI_CHECKED)
	GUICtrlSetState($CtrlCheckbox, $GUI_DISABLE)

EndFunc


Func _EndProcess($CtrlIcon, $CtrlCheckbox, $iconIndex)

	GUICtrlSetImage($CtrlIcon, @ScriptFullPath, 205)
	GUICtrlSetState($CtrlCheckbox, $GUI_UNCHECKED)
	GUICtrlSetState($CtrlCheckbox, $GUI_ENABLE)
	Sleep(500)
	GUICtrlSetImage($CtrlIcon, @ScriptFullPath, $iconIndex)

EndFunc


Func _CloseWindowsRepair()

	Exit

EndFunc


Func _AboutDlg()

	;GUICtrlSetState($BTN_ABOUT, $GUI_DISABLE)
	WinSetTrans($GUI_CORE, Default, 220)

	Local $abTitle, $abVersion, $abCopyright
	Local $abHome, $abGNU
	Local $abSpaceLabel, $abSpaceProg, $abBtnOK
	Local $abPayPal, $abFacebook, $abTwittter, $abRSS
	Local $abLinkedIn, $abGoogle

	$DLG_ABOUT = GUICreate("About " & $PROG_NAME, 400, 450, -1, -1, BitOr($WS_CAPTION, $WS_POPUPWINDOW), $WS_EX_TOPMOST)
	GUISetFont(8.5, 400, 0, "Verdana", $DLG_ABOUT, 5)
	GUISetIcon(@ScriptFullPath, 204)

	GUISetOnEvent($GUI_EVENT_CLOSE, "_CloseAboutDlg", $DLG_ABOUT)

	GUICtrlCreateIcon(@ScriptFullPath, 99, 10, 10, 64, 64)
	$abPayPal = GUICtrlCreateIcon(@ScriptFullPath, 212, 320, 0, 64, 64)
	GUICtrlSetTip($abPayPal, "Help us keep our software free.")
	GUICtrlSetCursor($abPayPal, 0)
	$abTitle = GUICtrlCreateLabel($PROG_NAME, 88, 16, 220, 18)
	GUICtrlSetFont($abTitle, 11)
	$abVersion = GUICtrlCreateLabel("Version " & FileGetVersion(@ScriptFullPath), 88, 40, 220, 20)
	$abCopyright = GUICtrlCreateLabel("Copyright © 2015 Rizonesoft", 88, 55, 220, 20)
	GUICtrlSetColor($abCopyright, 0x888888)
	$abHome = GUICtrlCreateLabel("www.rizonesoft.com", 88, 80, 200, 20)
	GUICtrlSetColor($abHome, 0x0000FF)
	GUICtrlSetCursor($abHome, 0)

	GUICtrlCreateLabel("", 10, 110, 380, 1)
	GUICtrlSetBkColor(-1, 0xA0A0A0)
	GUICtrlCreateLabel("", 10, 111, 380, 1)
	GUICtrlSetBkColor(-1, 0xFFFFFF)

	$abGNU = GUICtrlCreateLabel("This program is free software: you can redistribute it and/or modify " & _
								"it under the terms of the GNU General Public License as published by " & _
								"the Free Software Foundation, either version 3 of the License, or " & _
								"(at your option) any later version." & @CRLF & @CRLF & _
								"This program is distributed in the hope that it will be useful, " & _
								"but WITHOUT ANY WARRANTY; without even the implied warranty of " & _
								"MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the " & _
								"GNU General Public License for more details.", 20, 125, 350, 180)
	GUICtrlSetColor($abGNU, 0x888888)
	GUICtrlCreateLabel(	"Contributors: Derick Payne (Rizonesoft).", 20, 280, 350, 50)
	;~ $LBL_ABOUTANNOUNCE = GUICtrlCreateLabel(	$PROG_NAME & " can now be Integrated into the Doors suite. " & _
	;~ 											"Click here to find out how.", 20, 330, 350, 35)
	;~ GUICtrlSetColor($LBL_ABOUTANNOUNCE, 0x0000FF)
	;~ GUICtrlSetCursor($LBL_ABOUTANNOUNCE, 0)


	Local $ScriptDirSplt = StringSplit(@ScriptDir, "\")
	Local $ScriptDrive  = $ScriptDirSplt[1]
	Local $drvSpaceUsed = DriveSpaceTotal($ScriptDrive) - DriveSpaceFree($ScriptDrive)

;~ 	$abSpaceLabel = GUICtrlCreateLabel("(" & $ScriptDrive & ") " & Round(DriveSpaceFree($ScriptDrive) / 1024, 1) & " GB free of " & _
;~ 					Round(DriveSpaceTotal($ScriptDrive) / 1024, 1) & " GB", 15, 380, 300, 15)
;~ 	$abSpaceProg = GUICtrlCreateProgress(15, 400, 350, 15)
;~ 	GUICtrlSetData($abSpaceProg, ($drvSpaceUsed / DriveSpaceTotal($ScriptDrive)) * 100)
	$abBtnOK = GUICtrlCreateButton("OK", 250, 400, 123, 33, $BS_DEFPUSHBUTTON)

	$abFacebook = GUICtrlCreateIcon(@ScriptFullPath, 207, 20, 400, 32, 32)
	GUICtrlSetTip($abFacebook, "Like us on Facebook and stay updated.")
	GUICtrlSetCursor($abFacebook, 0)
	$abTwittter = GUICtrlCreateIcon(@ScriptFullPath, 208, 55, 400, 32, 32)
	GUICtrlSetTip($abTwittter, "Follow us on Twitter for the latest updates.")
	GUICtrlSetCursor($abTwittter, 0)
	$abLinkedIn = GUICtrlCreateIcon(@ScriptFullPath, 209, 90, 400, 32, 32)
	GUICtrlSetTip($abLinkedIn, "Find us on LinkedIn.")
	GUICtrlSetCursor($abLinkedIn, 0)
	$abGoogle = GUICtrlCreateIcon(@ScriptFullPath, 210, 125, 400, 32, 32)
	GUICtrlSetTip($abGoogle, "Find us on Google.")
	GUICtrlSetCursor($abGoogle, 0)
	$abRSS = GUICtrlCreateIcon(@ScriptFullPath, 211, 160, 400, 32, 32)
	GUICtrlSetTip($abRSS, "Find us on Google.")
	GUICtrlSetCursor($abRSS, 0)

	GUICtrlSetOnEvent($abHome, "_HomePageClicked")
	GUICtrlSetOnEvent($abFacebook, "_OpenFacebook")
	GUICtrlSetOnEvent($abTwittter, "_FollowOnTwitter")
	GUICtrlSetOnEvent($abLinkedIn, "_OpenLinkedIn")
	GUICtrlSetOnEvent($abGoogle, "_OpenGoogle")
	GUICtrlSetOnEvent($abBtnOK, "_CloseAboutDlg")
	GUICtrlSetOnEvent($abPayPal, "_DonateSomething")

	GUISetState(@SW_SHOW, $DLG_ABOUT)


EndFunc

Func _CloseAboutDlg()

	;GUICtrlSetState($BTN_ABOUT, $GUI_ENABLE)
	GUIDelete($DLG_ABOUT)
	WinSetTrans($GUI_CORE, Default, 255)

EndFunc

Func _HomePageClicked()
	ShellExecute("http://www.rizonesoft.com")
EndFunc


Func _OpenFacebook()
	ShellExecute("https://www.facebook.com/rizonesoft")
EndFunc


Func _FollowOnTwitter()
	ShellExecute("https://twitter.com/rizonesoft")
EndFunc


Func _OpenLinkedIn()
	ShellExecute("http://www.linkedin.com/in/rizonesoft")
EndFunc


Func _OpenGoogle()
	ShellExecute("https://plus.google.com/+Rizonesoftsa/posts")
EndFunc


Func _DonateSomething()
	ShellExecute("https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=7UGGCSDUZJPFE")
EndFunc


;~ 32_errfunc()
;~ 43$set_silent5
;~ 28$imsgboxanswer = 244(262160, "Something went wrong!", "We intercepted a COM Error ! Please use the command line option for Windows management." & "" & @CRLF & @CRLF & "Number is : " & 198($oerrorhandler.number, 8) & @CRLF & "Windescription is : " & 327($oerrorhandler.windescription), $set_msgbtout)
;~ 20
;~ 21$imsgboxanswer = -1
;~ 216
;~ 22
;~ 8
;~ _editloggingwrite("A COM Error happened! (Number: " & 198($oerrorhandler.number, 8) & " ~ Windescription: " & 327($oerrorhandler.windescription) & ")", 2)
;~ $comerror = 1
;~ 33

; This is a custom error handler
Func _ComErrHandler()
    Local $HexError = Hex($oErrorHandler.number, 8)
    MsgBox(0, "", "We intercepted a COM Error !" & @CRLF & _
            "Number is: " & $HexError & @CRLF & _
            "WinDescription is: " & $oErrorHandler.windescription)
    $iEventError = 1 ; Use to check when a COM Error occurs
EndFunc   ;==>ErrFunc


Func _DrawStatusSizeFromPercentage($FrBar, $Perc, $BcLeft, $BcTop, $BcWidth, $BcHeight)

	If $Perc > -1 Then
		If $Perc > 100 Then $Perc = 100
		If $Perc = 0 Then
			GUICtrlSetState($FrBar, 32)
		Else

			If BitAND(GUICtrlGetState($FrBar), 32) = 32 Then
				GUICtrlSetState($FrBar, 16)
			EndIf
			GUICtrlSetPos($FrBar, $BcLeft + 1, $BcTop + 1, (($BcWidth - 2) * $Perc) / 100, $BcHeight - 2)
		EndIf
	EndIf

EndFunc