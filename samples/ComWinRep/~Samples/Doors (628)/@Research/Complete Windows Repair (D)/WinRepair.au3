#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.8.0
 Author:         myName

 Script Function:
	Template AutoIt script.

#ce ----------------------------------------------------------------------------


#AutoIt3Wrapper_Icon=Resources\WinRepair.ico
#AutoIt3Wrapper_UseUpx=n
#AutoIt3Wrapper_Res_Description=Complete Windows Repair
#AutoIt3Wrapper_Res_Fileversion=0.2.0.762
#AutoIt3Wrapper_Res_Fileversion_AutoIncrement=y
#AutoIt3Wrapper_Res_requestedExecutionLevel=requireAdministrator
#AutoIt3Wrapper_Res_Icon_Add=Resources\RunFixB.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\RunFix.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Complete.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico

#AutoIt3Wrapper_Res_Icon_Add=Resources\Malware.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\ComFix.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico

#AutoIt3Wrapper_Res_Icon_Add=Resources\RecBin.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\RecBCh.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\RBRemDel.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico

#AutoIt3Wrapper_Res_Icon_Add=Resources\FoldOp.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\FoldHidden.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\FoldView.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\AudioCD.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico

#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Asf.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Asx.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Exe.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico

#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico

#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico

#AutoIt3Wrapper_Res_Icon_Add=Resources\InEx.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\PNGFix.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Google.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico

#AutoIt3Wrapper_Res_Icon_Add=Resources\RegEdit.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Gear.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Script.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico
#AutoIt3Wrapper_Res_Icon_Add=Resources\Default.ico

Opt("TrayMenuMode", 1) ;~ Default tray menu items (Script Paused/Exit) will not be shown.
Opt("MustDeclareVars", 1)
Opt("GUIOnEventMode", 1)


#include <WindowsConstants.au3>
#include <GUIConstantsEx.au3>
#include <GuiButton.au3>
#Include <GuiEdit.au3>
#include <Misc.au3>

#include <UDF\Services.au3>
#include <UDF\CoreWinRepair.au3>
#include <UDF\Components_Home.au3>
#include <UDF\Components_Clean.au3>
#include <UDF\Components_Desktop.au3>
#include <UDF\Components_Explorer.au3>
#include <UDF\Components_Associations.au3>
#include <UDF\Components_Associations2.au3>
#include <UDF\Components_Internet.au3>
#include <UDF\Components_System.au3>



Global Const $processRes = @ScriptDir & "\Themes\101.ani"

Global $crepForm, $cwrIco, $eStatus

Global $btnHome, $btnClean, $btnDesktop, $btnExplorer, $btnAssociations, $btnAssociations2, $btnApplications, $btnInternet, $btnSystem
Global $homePage, $homeGroup, $btnSFCScan, $btnRestore, $btnHomeNext

Global $cleanPage, $cleanGroup,  $btnCleanBack, $btnCleanNext, $cleanBtnGo, $cleanCount = 19
Global $cleanChk[$cleanCount + 1], $cleanRepIco[$cleanCount + 1], $cleanRepBtn[$cleanCount + 1], $cleanHover[$cleanCount + 1]
Global $deskPage, $deskGroup, $btnDeskBack, $btnDeskNext, $deskBtnGo, $deskCount = 19
Global $deskChk[$deskCount + 1], $deskRepIco[$deskCount + 1], $deskRepBtn[$deskCount + 1], $deskHover[$deskCount + 1]
Global $explPage, $explGroup, $btnExplBack, $btnExplNext, $explCount = 19
Global $explChk[$explCount + 1], $explRepIco[$explCount + 1], $explRepBtn[$explCount + 1], $explHover[$explCount + 1]
Global $assPage, $assGroup, $btnAssBack, $btnAssNext, $assBtnGo, $assCount = 19
Global $assChk[$assCount + 1], $assRepIco[$assCount + 1], $assRepBtn[$assCount + 1], $assHover[$assCount + 1]
Global $ass2Page, $ass2Group, $btnAss2Back, $btnAss2Next, $ass2BtnGo, $ass2Count = 19
Global $ass2Chk[$ass2Count + 1], $ass2RepIco[$ass2Count + 1], $ass2RepBtn[$ass2Count + 1], $ass2Hover[$ass2Count + 1]
Global $appPage, $appGroup, $btnAppBack, $btnAppNext, $appBtnGo, $appCount = 19
Global $appChk[$assCount + 1], $appRepIco[$appCount + 1], $appRepBtn[$appCount + 1], $appHover[$appCount + 1]

Global $intPage, $intGroup, $btnIntBack, $btnIntNext, $intBtnGo, $intCount = 19
Global $intChk[$intCount + 1], $intRepIco[$intCount + 1], $intRepBtn[$intCount + 1], $intHover[$intCount + 1]
Global $sysPage, $sysGroup, $btnSysBack, $sysBtnGo, $sysCount = 19
Global $sysChk[$sysCount + 1], $sysRepIco[$sysCount + 1], $sysRepBtn[$sysCount + 1], $sysHover[$sysCount + 1]


If _Singleton(@ScriptName, 1) = 0 Then

	MsgBox(262192, "Warning!", "An occurence of 'Complete Windows Repair' is already running.", 30)
	Exit

Else

	_InitializeLogFile($LOGGING_WINREPAIR, 5)

	If Not FileExists(@ScriptDir & "\Themes") Then DirCreate(@ScriptDir & "\Themes")
	FileInstall("Resources\101.ani", $processRes, 0)

	_LoggingWrite("", False)
	_LoggingWrite("", False)
	_LoggingWrite("                                            ./", False)
	_LoggingWrite("                                          (o o)", False)
	_LoggingWrite("--------------------------------------oOOo-(_)-oOOo--------------------------------------", False)



	_ShowMainGUI()

EndIf


Func _ShowMainGUI()

	Local $GuiMsg, $mainTAB
	Local Const $Gap = 20

	$crepForm = GUICreate("Rizonesoft Complete Windows Repair " & FileGetVersion(@ScriptFullPath), 650, 650)
	GUISetFont(8.5, 400, -1, "Verdana", $crepForm, 5)

	$cwrIco = GUICtrlCreateIcon(@ScriptFullPath, 99, 43, 10, 64, 64)

	$btnHome = GUICtrlCreateButton("Home", 10, 100, 130, 30)
	$btnClean = GUICtrlCreateButton("Clean", 10, 130, 130, 30)
	$btnDesktop = GUICtrlCreateButton("Desktop", 10, 160, 130, 30)
	$btnExplorer = GUICtrlCreateButton("Explorer", 10, 190, 130, 30)
	$btnAssociations = GUICtrlCreateButton("Associations (1)", 10, 220, 130, 30)
	$btnAssociations2 = GUICtrlCreateButton("Associations (2)", 10, 250, 130, 30)
	$btnApplications = GUICtrlCreateButton("Applications", 10, 280, 130, 30)
	$btnInternet = GUICtrlCreateButton("Internet", 10, 310, 130, 30)
	$btnSystem = GUICtrlCreateButton("System", 10, 340, 130, 30)

	GuiCtrlSetOnEvent($btnHome, "_SelectPage")
	GuiCtrlSetOnEvent($btnClean, "_SelectPage")
	GuiCtrlSetOnEvent($btnDesktop, "_SelectPage")
	GuiCtrlSetOnEvent($btnExplorer, "_SelectPage")
	GuiCtrlSetOnEvent($btnAssociations, "_SelectPage")
	GuiCtrlSetOnEvent($btnAssociations2, "_SelectPage")
	GuiCtrlSetOnEvent($btnApplications, "_SelectPage")
	GuiCtrlSetOnEvent($btnInternet, "_SelectPage")
	GuiCtrlSetOnEvent($btnSystem, "_SelectPage")


;~ 	$eStatus = GUICtrlCreateEdit("", 150, 530, 490, 95, BitOR($WS_VSCROLL, $WS_HSCROLL, $ES_READONLY, $ES_AUTOVSCROLL, $ES_MULTILINE))
;~ 	GUICtrlSetBkColor($eStatus, 0xFFFFFF)


	$mainTAB = GUICtrlCreateTab(150, -25, 525, 550)

	$homePage = GUICtrlCreateTabItem("Home")
	$homeGroup = GuiCtrlCreateGroup("Welcome", 165, 10, 470, 450)
	GUICtrlSetFont($homeGroup, 10)

	GuiCtrlCreateLabel(	"Windows has this nasty little habit of breaking down, mostly because of malicious software. " & _
						"Normally malware uses a feature of Windows called policies to lock you out of certain " & _
						"functions. If that was not bad enough, malware also uses other techniques or configuration " & _
						"changes to make life suck just a little more. Apart from all of this, you also need to " & _
						"deal with file corruption and other badly programmed applications messing things up. With " & _
						"millions of things that can go wrong with your Windows computer, the 100 or so solutions are " & _
						"just not adequate. Complete Windows Repair tries to fill the gaps. " & @CRLF & @CRLF & _
						"Before you try any of the solutions we suggest you scan your system files using a little hidden " & _
						"Windows utility called System File Checker (SFC). To scan your system files you can run the " & Chr(34) & "sfc  " & _
						"/scannow" & Chr(34) & " command from the Windows command prompt or click the Scannow button below. Let SFC do " & _
						"its thing and reboot your computer if asked.  ", 190, 50, 420, 210)

	$btnSFCScan = GUICtrlCreateButton("Scannow", 200, 280, 130, 30)

	GuiCtrlCreateLabel(	"It is highly recommended that you create a system restore point in case Complete Windows Repair " & _
						"breaks something. Click the button below to create a system restore point. ", 190, 340, 420, 50)

	$btnRestore = GuiCTrlCreateButton("Create system restore point", 200, 410, 200, 30)

	GuiCtrlSetOnEvent($btnSFCScan, "_RunSystemFileScanner")
	GuiCtrlSetOnEvent($btnRestore, "_CreateSystemRestorePoint")

	GUICtrlCreateGroup("", -99, -99, 1, 1)  ;~ Close group
;~ 	$btnHomeNext = GUICtrlCreateButton("Next", 165, 480, 100, 30)
;~ 	GuiCtrlSetOnEvent($btnHomeNext, "_SelectPage")

;~ 	$cleanPage = GUICtrlCreateTabItem("Clean")
;~ 	$cleanGroup = GuiCtrlCreateGroup("", 165, 10, 470, 450)
;~ 	GUICtrlSetFont($cleanGroup, 10)

;~ 	For $i = 0 To $cleanCount
;~ 		$cleanRepIco[$i] = GUICtrlCreateIcon(@ScriptFullPath, 205 + $i, 190, 45 + ($i * $Gap), 16, 16)
;~ 		GUICtrlSetCursor($cleanRepIco[$i], 0)
;~ 		$cleanChk[$i] = GUICtrlCreateCheckbox(" Repair something here!", 220, 45 + ($i * $Gap), 300, 16)
;~ 		$cleanHover[$i] = 1
;~ 		$cleanRepBtn[$i] = GUICtrlCreateIcon(@ScriptFullPath, 201, 540, 45 + ($i * $Gap), 16, 16)
;~ 		GUICtrlSetCursor($cleanRepBtn[$i], 0)
;~ 		GuiCtrlSetOnEvent($cleanRepBtn[$i], "_RunClean")
;~ 	Next

	GuiCtrlSetData($cleanChk[0], " Remove common Malware and Traces")

	GUICtrlCreateGroup("", -99, -99, 1, 1)  ;~ Close group

	$btnCleanBack = GUICtrlCreateButton("Back", 165, 480, 100, 30)
	$btnCleanNext = GUICtrlCreateButton("Next", 265, 480, 100, 30)

	GuiCtrlSetOnEvent($btnCleanBack, "_SelectPage")
	GuiCtrlSetOnEvent($btnCleanNext, "_SelectPage")

	$cleanBtnGo = GUICtrlCreateButton("Go!", 465, 470, 150, 40)
	GUICtrlSetFont($cleanBtnGo, 12)


	$deskPage = GUICtrlCreateTabItem("Desktop")
	$deskGroup = GuiCtrlCreateGroup("Desktop", 165, 10, 470, 450)
	GUICtrlSetFont($deskGroup, 10)

	For $i = 0 To $deskCount
		$deskRepIco[$i] = GUICtrlCreateIcon(@ScriptFullPath, 225 + $i, 190, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($deskRepIco[$i], 0)
		$deskChk[$i] = GUICtrlCreateCheckbox(" Repair something here!", 220, 45 + ($i * $Gap), 300, 16)
		$deskHover[$i] = 1
		$deskRepBtn[$i] = GUICtrlCreateIcon(@ScriptFullPath, 201, 540, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($deskRepBtn[$i], 0)
		GuiCtrlSetOnEvent($deskRepBtn[$i], "_RunDesktopRepair")
	Next

	GuiCtrlSetData($deskChk[0], " Restore missing Recycle Bin")
	GuiCtrlSetData($deskChk[1], " Recycle Bin does not refresh (Restore Icons)")
	GuiCtrlSetData($deskChk[2], _ReturnRemoveDeleteCaption())
;~ 	GuiCtrlSetData($deskChk[2], " Restore Windows Sidebar")
;~ 	GuiCtrlSetData($deskChk[3], " Repair Windows Aero")
;~ 	GuiCtrlSetData($deskChk[4], " Repair the Icon View")
;~ 	GuiCtrlSetData($deskChk[5], " Increase Icon Cache DB size to 4MB")
;~ 	GuiCtrlSetData($deskChk[6], " Rebuild the Icon Cache")
;~ 	GuiCtrlSetData($deskChk[7], " Computer Icon is not in Start Menu")
;~ 	GuiCtrlSetData($deskChk[8], " Repair Desktop Shortcuts")
;~ 	GuiCtrlSetData($deskChk[9], " Repair corrupted Recycle Bin")
;~ 	GuiCtrlSetData($deskChk[10], " Resore default Recycle Bin icons")
;~ 	GuiCtrlSetData($deskChk[11], " Restore Recycle Bin missing from Desktop")
;~ 	GuiCtrlSetData($deskChk[12], " Remove Delete option from the Recycle Bin")
;~ 	GuiCtrlSetData($deskChk[13], " Restore Action Center and Security Center")
;~ 	GuiCtrlSetData($deskChk[14], " Reset Windows Search to defaults")
;~ 	GuiCtrlSetData($deskChk[15], " Restore the Sticky Notes delete warning")
;~ 	GuiCtrlSetData($deskChk[16], " Restore the Hibernate feature")

	GuiCtrlSetTip($deskRepIco[0], 	"The Recycle Bin does not appear on the desktop in Windows 7, " & @CRLF & _
									"Vista or XP. This option will make the Recycle Bin work again." & @CRLF & _
									"Also helps if the Recycle Bin icon does not refresh automatically.", _
									"Restore missing Recycle Bin", 1, 1)
	GuiCtrlSetTip($deskRepIco[2], 	"Configures the Recycle Bin context menu to mimic Windows 7." & @CRLF & _
									"Removes the Delete option in Windows Vista." & @CRLF & _
									"Adds the Rename option in Windows 2000 and XP.", _
									"Remove Delete, add Rename to Recycle Bin", 1, 1)
;~ 	GuiCtrlSetTip($deskRepIco[3], 	"Set Desktop icons size back to default.")
;~ 	GuiCtrlSetTip($deskRepIco[4], 	"The default value (500) is just not big enough." & @CRLF & _
;~ 									"This will also repair icons displaying funny.")
;~ 	GuiCtrlSetTip($deskRepIco[5], 	"When icons are not displaying accurately, use this option.")
;~ 	GuiCtrlSetTip($deskRepIco[6], 	"Find the Computer icon missing in action.")

	GUICtrlCreateGroup("", -99, -99, 1, 1)  ;~ Close group

	$btnDeskBack = GUICtrlCreateButton("Back", 165, 480, 100, 30)
	$btnDeskNext = GUICtrlCreateButton("Next", 265, 480, 100, 30)

	GuiCtrlSetOnEvent($btnDeskBack, "_SelectPage")
	GuiCtrlSetOnEvent($btnDeskNext, "_SelectPage")

	$deskBtnGo = GUICtrlCreateButton("Go!", 465, 470, 150, 40)
	GUICtrlSetFont($deskBtnGo, 12)
;~ 	GuiCtrlSetOnEvent($deskBtnGo, "_GoDesktopRepair")


	$explPage = GUICtrlCreateTabItem("Explorer")
	$explGroup = GuiCtrlCreateGroup("Explorer", 165, 10, 470, 450)
	GUICtrlSetFont($explGroup, 10)

	For $i = 0 To $explCount
		$explRepIco[$i] = GUICtrlCreateIcon(@ScriptFullPath, 245 + $i, 190, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($explRepIco[$i], 0)
		$explChk[$i] = GUICtrlCreateCheckbox(" Repair something here!", 220, 45 + ($i * $Gap), 300, 16)
		$explHover[$i] = 1
		$explRepBtn[$i] = GUICtrlCreateIcon(@ScriptFullPath, 201, 570, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($explRepBtn[$i], 0)
		GuiCtrlSetOnEvent($explRepBtn[$i], "_RunExplorerRepair")
	Next

	GuiCtrlSetData($explChk[0], " Restore Folder Options")
	GuiCtrlSetData($explChk[1], " Enable Show Hidden Files and Folders")
	GuiCtrlSetData($explChk[2], " Restore default folder view settings")
	GuiCtrlSetData($explChk[3], " Restore Audio CD protocol associations")

	GuiCtrlSetTip($explRepIco[0],	"Some malware will modify Windows configuration to prevent users from " & @CRLF & _
									"accessing Folder Options.", _
									"Enable Folder Options", 1, 1)
	GuiCtrlSetTip($explRepIco[1],	"Some malware will modify Windows configuration to prevent users from " & @CRLF & _
									"changing the settings of Show Hidden Files and Folders.", _
									"Enable Show Hidden Files and Folders", 1, 1)
	GuiCtrlSetTip($explRepIco[2],	"When you open a Web page, PNG images in that page are not displayed, " & @CRLF & _
									"Instead, a red X, or a placeholder, may appear in place.", _
									"Restore default folder view settings", 1, 1)

	GUICtrlCreateGroup("", -99, -99, 1, 1)  ;~ Close group

	$btnExplBack = GUICtrlCreateButton("Back", 165, 480, 100, 30)
	$btnExplNext = GUICtrlCreateButton("Next", 265, 480, 100, 30)

	GuiCtrlSetOnEvent($btnExplBack, "_SelectPage")
	GuiCtrlSetOnEvent($btnExplNext, "_SelectPage")


	$assPage = GUICtrlCreateTabItem("Associations")
	$assGroup = GuiCtrlCreateGroup("Restore default file type associations (1)", 165, 10, 470, 450)
	GUICtrlSetFont($assGroup, 10)

	For $i = 0 To $assCount
		$assRepIco[$i] = GUICtrlCreateIcon(@ScriptFullPath, 265 + $i, 190, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($assRepIco[$i], 0)
		$assChk[$i] = GUICtrlCreateCheckbox(" Repair something here!", 220, 45 + ($i * $Gap), 300, 16)
		$assHover[$i] = 1
		$assRepBtn[$i] = GUICtrlCreateIcon(@ScriptFullPath, 201, 580, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($assRepBtn[$i], 0)
		GuiCtrlSetOnEvent($assRepBtn[$i], "_RunAssociations")
	Next

	GuiCtrlSetData($assChk[0], " (.ani) Windows animated cursor file")
	GuiCtrlSetData($assChk[1], " (.asf) Advanced Streaming Format (WMP)")
	GuiCtrlSetData($assChk[2], " (.aspx) ASP.NET Source file")
	GuiCtrlSetData($assChk[3], " (.asx) Advanced Stream Redirector (WMP)")

	GuiCtrlSetTip($assRepIco[1],	"The default program is Windows Media Player.", _
									"Advanced Streaming Format", 1, 1)
	GuiCtrlSetTip($assRepIco[3],	"Also known as Windows Media Metafiles. text files that provide " & @CRLF & _
									"information about a file stream and its presentation." & @CRLF & _
									"The default program is Windows Media Player.", _
									"Advanced Stream Redirector play list files", 1, 1)

	GUICtrlCreateGroup("", -99, -99, 1, 1)  ;~ Close group

	$btnAssBack = GUICtrlCreateButton("Back", 165, 480, 100, 30)
	$btnAssNext = GUICtrlCreateButton("Next", 265, 480, 100, 30)

	GuiCtrlSetOnEvent($btnAssBack, "_SelectPage")
	GuiCtrlSetOnEvent($btnAssNext, "_SelectPage")


	$ass2Page = GUICtrlCreateTabItem("Associations (2)")
	$ass2Group = GuiCtrlCreateGroup("Restore default file type associations (2)", 165, 10, 470, 450)
	GUICtrlSetFont($ass2Group, 10)

	For $i = 0 To $ass2Count
		$ass2RepIco[$i] = GUICtrlCreateIcon(@ScriptFullPath, 285 + $i, 190, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($ass2RepIco[$i], 0)
		$ass2Chk[$i] = GUICtrlCreateCheckbox(" Repair something here!", 220, 45 + ($i * $Gap), 300, 16)
		$ass2Hover[$i] = 1
		$ass2RepBtn[$i] = GUICtrlCreateIcon(@ScriptFullPath, 201, 580, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($ass2RepBtn[$i], 0)
		GuiCtrlSetOnEvent($ass2RepBtn[$i], "_RunAssociations2")
	Next

	GuiCtrlSetData($ass2Chk[0], " ")
	GuiCtrlSetData($ass2Chk[1], " ")

	GUICtrlCreateGroup("", -99, -99, 1, 1)  ;~ Close group

	$btnAss2Back = GUICtrlCreateButton("Back", 165, 480, 100, 30)
	$btnAss2Next = GUICtrlCreateButton("Next", 265, 480, 100, 30)

	GuiCtrlSetOnEvent($btnAss2Back, "_SelectPage")
	GuiCtrlSetOnEvent($btnAss2Next, "_SelectPage")


	$appPage = GUICtrlCreateTabItem("Applications")
	$appGroup = GuiCtrlCreateGroup("Applications", 165, 10, 470, 450)
	GUICtrlSetFont($appGroup, 10)

	For $i = 0 To $appCount
		$appRepIco[$i] = GUICtrlCreateIcon(@ScriptFullPath, 305 + $i, 190, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($appRepIco[$i], 0)
		$appChk[$i] = GUICtrlCreateCheckbox(" Repair something here!", 220, 45 + ($i * $Gap), 300, 16)
		$appHover[$i] = 1
		$appRepBtn[$i] = GUICtrlCreateIcon(@ScriptFullPath, 201, 580, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($appRepBtn[$i], 0)
		GuiCtrlSetOnEvent($appRepBtn[$i], "_RunApplications")
	Next

	GuiCtrlSetData($appChk[0], " (*.bas) BASIC source code file")

	GUICtrlCreateGroup("", -99, -99, 1, 1)  ;~ Close group

	$btnAppBack = GUICtrlCreateButton("Back", 165, 480, 100, 30)
	$btnAppNext = GUICtrlCreateButton("Next", 265, 480, 100, 30)

	GuiCtrlSetOnEvent($btnAppBack, "_SelectPage")
	GuiCtrlSetOnEvent($btnAppNext, "_SelectPage")


	$intPage = GUICtrlCreateTabItem("Internet")
	$intGroup = GuiCtrlCreateGroup("Internet", 165, 10, 470, 450)
	GUICtrlSetFont($intGroup, 10)

	For $i = 0 To $intCount
		$intRepIco[$i] = GUICtrlCreateIcon(@ScriptFullPath, 325 + $i, 190, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($intRepIco[$i], 0)
		$intChk[$i] = GUICtrlCreateCheckbox(" Repair something here!", 220, 45 + ($i * $Gap), 300, 16)
		$intHover[$i] = 1
		$intRepBtn[$i] = GUICtrlCreateIcon(@ScriptFullPath, 201, 540, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($intRepBtn[$i], 0)
		GuiCtrlSetOnEvent($intRepBtn[$i], "_RunInternetRepair")
	Next

	GuiCtrlSetData($intChk[0], " Repair Internet Explorer " & _GetIntExplorerVersion())
	GuiCtrlSetData($intChk[1], " PNG images not displayed in Internet Explorer")
	GuiCtrlSetData($intChk[2], " Set Google as Home Page and Search Provider")

	GuiCtrlSetTip($intRepIco[1],	"When you open a Web page, PNG images in that page are not displayed, " & @CRLF & _
									"Instead, a red X, or a placeholder, may appear in place.", _
									"PNG images are not displayed in Internet Explorer", 1, 1)

	GUICtrlCreateGroup("", -99, -99, 1, 1)  ;~ Close group

	$btnIntBack = GUICtrlCreateButton("Back", 165, 480, 100, 30)
	$btnIntNext = GUICtrlCreateButton("Next", 265, 480, 100, 30)

	GuiCtrlSetOnEvent($btnIntBack, "_SelectPage")
	GuiCtrlSetOnEvent($btnIntNext, "_SelectPage")

	$intBtnGo = GUICtrlCreateButton("Go!", 465, 470, 150, 40)
	GUICtrlSetFont($intBtnGo, 12)
;~ 	GuiCtrlSetOnEvent($intBtnGo, "_GoInternetRepair")


	$sysPage = GUICtrlCreateTabItem("System")
	$sysGroup = GuiCtrlCreateGroup("System", 165, 10, 470, 450)
	GUICtrlSetFont($sysGroup, 10)

	For $i = 0 To $sysCount
		$sysRepIco[$i] = GUICtrlCreateIcon(@ScriptFullPath, 345 + $i, 190, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($sysRepIco[$i], 0)
		$sysChk[$i] = GUICtrlCreateCheckbox(" Repair something here!", 220, 45 + ($i * $Gap), 300, 16)
		$sysHover[$i] = 1
		$sysRepBtn[$i] = GUICtrlCreateIcon(@ScriptFullPath, 201, 540, 45 + ($i * $Gap), 16, 16)
		GUICtrlSetCursor($sysRepBtn[$i], 0)
		GuiCtrlSetOnEvent($sysRepBtn[$i], "_RunSystemRepair")
	Next

	GuiCtrlSetData($sysChk[0], " Reset Registry Permissions")
	GuiCtrlSetData($sysChk[1], " Register Windows System files")
	GuiCtrlSetData($sysChk[2], " Repair Windows Script")

	GuiCtrlSetTip($sysRepIco[2],	"This can repair a lot of Windows errors, " & @CRLF & _
									"mostly Windows crashing and applications not starting.", _
									"Register Windows System files", 1, 1)

	GUICtrlCreateGroup("", -99, -99, 1, 1)  ;~ Close group

	$btnSysBack = GUICtrlCreateButton("Back", 165, 480, 100, 30)
	GuiCtrlSetOnEvent($btnSysBack, "_SelectPage")

	;


;~ 	GuiCtrlSetTip($intRepIco[0], 	"This option rewrites important registry keys that are used by " & @CRLF & _
;~ 								"the Internet Protocol (TCP/IP) stack. This has the same result " & @CRLF & _
;~ 								"as removing and reinstalling the protocol.")
;~ 	GuiCtrlSetTip($intRepIco[1], 	"This can be used to recover from Winsock corruption result in lost " & @CRLF & _
;~ 								"of network connectivity. This option should be used with care "  & @CRLF & _
;~ 								"becuase any pre-installed LSPs will need to be reinstalled.")
;~ 	GuiCtrlSetTip($intRepIco[2], 	"Release and renew all Interent (TCP/IP) connections.")
;~ 	GuiCtrlSetTip($intRepIco[3], 	"Flush DNS Resolver Cache, refresh all DHCP leases and " & @CRLF & _
;~ 								"re-register DNS names.")
	GuiCtrlSetTip($intRepIco[0], 	"Re-registers all the concerned dll and ocx files required for " & @CRLF & _
									"the smooth operation of Internet Explorer " & "" & ".")
;~ 	GuiCtrlSetTip($intRepIco[5], 	"This option will clear the Windows Update History. "  & @CRLF & _
;~ 								"It will do this by emptying the " & @CRLF & _
;~ 								"[" & "" & "]" & @CRLF & "[" & "" & "] directories.")
;~ 	GuiCtrlSetTip($intRepIco[6], 	"This option will try and fix Windows Update / Automatic Updates. " & @CRLF & _
;~ 								"Try this when you are unable to download or install updates.")
;~ 	GuiCtrlSetTip($intRepIco[7], 	"If you are having trouble connecting to SSL / Secured websites " & @CRLF & _
;~ 								"(Ex. Banking) then this option could help.")
;~ 	GuiCtrlSetTip($intRepIco[8], 	"Reset the Windows Firewall configuration to its default state.")
;~ 	GuiCtrlSetTip($intRepIco[9], 	"Restore access permissions to the hosts file. " & @CRLF & _
;~ 									"If you are unable to edit the Hosts file.")
;~ 	GuiCtrlSetTip($intRepIco[10], 	"Reset the Windows hosts file to its default state.")
;~ 	GuiCtrlSetTip($intRepIco[11], 	"Select this option if you cannot view other "  & @CRLF & _
;~ 								"workgroup computers on the network.")

;~ 	GuiCtrlSetData($intChk[0], " Reset Internet Protocol (TCP/IP)")
;~ 	GuiCtrlSetData($intChk[1], " Repair Winsock (Reset Catalog)")
;~ 	GuiCtrlSetData($intChk[2], " Renew Internet Connections")
;~ 	GuiCtrlSetData($intChk[3], " Flush DNS Resolver Cache")

;~ 	GuiCtrlSetData($intChk[5], " Clear Windows Update History")
;~ 	GuiCtrlSetData($intChk[6], " Repair Windows / Automatic Updates")
;~ 	GuiCtrlSetData($intChk[7], " Repair SSL / HTTPS / Cryptography")
;~ 	GuiCtrlSetData($intChk[8], " Reset Windows Firewall Configuration")
;~ 	GuiCtrlSetData($intChk[9], " Restore access to the HOSTS file")
;~ 	GuiCtrlSetData($intChk[10], " Recover the default HOSTS file")
;~ 	GuiCtrlSetData($intChk[11], " Repair Workgroup Computers view")

;~ 	GUICtrlCreateGroup("", -99, -99, 1, 1)  ;~ Close group





;~ 	$explPage = GUICtrlCreateTabItem("Explorer")
;~ 	$explGroup = GuiCtrlCreateGroup("2) Explorer", 165, 10, 470, 420)

;~ 	For $i = 0 To $explCount
;~ 		$explRepIco[$i] = GUICtrlCreateIcon(@ScriptFullPath, 250 + $i, 190, 120 + ($i * $Gap), 16, 16)
;~ 		GUICtrlSetCursor($explRepIco[$i], 0)
;~ 		$explChk[$i] = GUICtrlCreateCheckbox("Repair something here!", 220, 120 + ($i * $Gap), 240, 16)
;~ 		$explHover[$i] = 1
;~ 		$explRepBtn[$i] = GUICtrlCreateIcon(@ScriptFullPath, 201, 540, 120 + ($i * $Gap), 16, 16)
;~ 		GUICtrlSetCursor($explRepBtn[$i], 0)
;~ 		;GuiCtrlSetOnEvent($explRepBtn[$i], "_RunRepair")
;~ 	Next

;~ 	GUICtrlSetFont($explGroup, 10)

;~ 	GuiCtrlSetTip($explRepIco[0], 	"Some malware have this nasty habit of changing your Windows shell " & @CRLF & _
;~ 									"to something different than Explorer. When this happens " & @CRLF & _
;~ 									"you will not be able to access the TaskBar or programs. " & @CRLF & _
;~ 									"This option will restore the default Windows Shell.")

;~ 	GuiCtrlSetData($explChk[0], " Restore Windows Explorer Shell")
;~ 	GuiCtrlSetData($explChk[1], " Recover missing CD Drive icon")
;~ 	GuiCtrlSetData($explChk[2], " Reset Autorun settings")

;~ 	GUICtrlCreateGroup("", -99, -99, 1, 1)  ;~ Close group

	GUICtrlCreateTabItem("") ; end tabitem definition



	GUISetState(@SW_SHOW)

	GUIRegisterMsg($WM_COMMAND, "MY_WM_COMMAND")
	GUISetOnEvent($GUI_EVENT_CLOSE, "_CloseWindowsRepair")

	While 1

		Sleep(35)
		_ExplorerHover()

	WEnd

EndFunc


Func MY_WM_COMMAND($hWnd, $iMsg, $wParam, $lParam)

    Switch BitAND($wParam, 0xFFFF) ;LoWord = IDFrom
		Case $deskBtnGo
            Switch BitShift($wParam, 16) ;HiWord = Code
				Case $BN_CLICKED
					If GUICtrlRead($deskBtnGo) = "Stop!" Then
						$CancelRepair = True
					EndIf
			EndSwitch
		Case $intBtnGo
            Switch BitShift($wParam, 16) ;HiWord = Code
				Case $BN_CLICKED
					If GUICtrlRead($intBtnGo) = "Stop!" Then
						$CancelRepair = True
					EndIf
			EndSwitch
    EndSwitch

    Return $GUI_RUNDEFMSG
EndFunc;==>WM_COMMAND


Func _ExplorerHover()
	Local $cursor = GUIGetCursorInfo()
	If Not @error Then
		For $a = 0 To $explCount
			If $cursor[4] = $explRepBtn[$a] And $explHover[$a] = 1 Then
				$explHover[$a] = 0
				GUICtrlSetImage($explRepBtn[$a], @ScriptFullPath, 202)
			ElseIf $cursor[4] <> $explRepBtn[$a] And $explHover[$a] = 0 Then
				$explHover[$a] = 1
				GUICtrlSetImage($explRepBtn[$a], @ScriptFullPath, 201)
			EndIf
		Next
	EndIf
EndFunc





Func _RunClean()

	_StartProcess()

	Switch @GUI_CtrlId
		Case $cleanRepBtn[0]
			_RemoveMalwareAndTraces()
	EndSwitch

	_EndProcess()

EndFunc


Func _RunDesktopRepair()

	_StartProcess()

	Switch @GUI_CtrlId
		Case $deskRepBtn[0]
			_RestoreMissingRecycleBin()
		Case $deskRepBtn[1]
			_RestoreRecycleBinIcons()
		Case $deskRepBtn[2]
			_RemoveDeleteAddRename()
	EndSwitch

	_EndProcess()

EndFunc


Func _RunExplorerRepair()

	_StartProcess()

	Switch @GUI_CtrlId
		Case $explRepBtn[0]
			_RestoreFolderOptions()
		Case $explRepBtn[1]
			_EnableShowHiddenFiles()
	EndSwitch

	_EndProcess()

EndFunc


Func _RunAssociations()

	_StartProcess()

	Switch @GUI_CtrlId
		Case $assRepBtn[0]
			_RestoreAniAssociations()
		Case $assRepBtn[1]
			_RestoreAsfAssociations()
		Case $assRepBtn[2]
			_RestoreAspxAssociations()
		Case $assRepBtn[3]
			_RestoreAsxAssociations()
	EndSwitch

	_EndProcess()

EndFunc


Func _RunAssociations2()

	_StartProcess()

	Switch @GUI_CtrlId
		Case $ass2RepBtn[0]

	EndSwitch

	_EndProcess()

EndFunc


Func _RunApplications()

	_StartProcess()

	Switch @GUI_CtrlId
		Case $assRepBtn[0]
	EndSwitch

	_EndProcess()

EndFunc


;~ Func _GoDesktopRepair()

;~ 	_StartDesktopRepair()

;~ 	For $i = 0 To $deskCount
;~ 		If GUICtrlRead($deskChk[$i]) = $GUI_CHECKED Then
;~ 			If GUICtrlRead($deskChk[$i], 1) = " Restore Taskbar and Start Menu (Shell)" Then
;~ 				If Not $CancelRepair Then
;~ 					_RestoreWindowsShell()
;~ 					_RepairTaskBar()
;~ 					$RUN_TBDESKRESTORE = False
;~ 				EndIf
;~ 				_SetDeskCompleteStatus($i)
;~ 			If GUICtrlRead($deskChk[$i], 1) = " Repair the Windows TaskBar" Then
;~ 				If Not $CancelRepair And $RUN_TBDESKRESTORE Then _RepairTaskBar()
;~ 				_SetDeskCompleteStatus($i)
;~ 			If GUICtrlRead($deskChk[$i], 1) = " Restore missing Recycle Bin" Then
;~ 				If Not $CancelRepair Then _RestoreMissingRecycleBin()
;~ 				_SetDeskCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($deskChk[$i], 1) = " Recycle Bin does not refresh (Restore Icons)" Then
;~ 				If Not $CancelRepair Then _RestoreRecycleBinIcons()
;~ 				_SetDeskCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($deskChk[$i], 1) = _ReturnRemoveDeleteCaption() Then
;~ 				If Not $CancelRepair Then _RemoveDeleteAddRename()
;~ 				_SetDeskCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($deskChk[$i], 1) = " Increase Icon Cache DB size to 4MB" Then
;~ 				If Not $CancelRepair Then
;~ 					_SetIconCacheSize()
;~ 					_RebuildIconCache()
;~ 					$RUN_REBUILDICONCACHE = False
;~ 				EndIf
;~ 				_SetDeskCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($deskChk[$i], 1) = " Rebuild the Icon Cache" Then
;~ 				If Not $CancelRepair And $RUN_REBUILDICONCACHE Then _RebuildIconCache()
;~ 				_SetDeskCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($deskChk[$i], 1) = " Computer Icon is not in Start Menu" Then
;~ 				If Not $CancelRepair Then _MissingComputerIcon()
;~ 				_SetDeskCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($deskChk[$i], 1) = " Repair corrupted Recycle Bin" Then
;~ 				If Not $CancelRepair Then _RepairCorruptedRecycleBin()
;~ 				_SetDeskCompleteStatus($i)




;~ 			EndIf
;~ 		EndIf
;~ 	Next

;~ 	_EndDesktopRepair()


;~ EndFunc


Func _SetDeskCompleteStatus($index)
	GUICtrlSetState($deskChk[$index], $GUI_UNCHECKED)
	If Not $CancelRepair Then GUICtrlSetImage($deskRepIco[$index], @ScriptFullPath, 203)
EndFunc





Func _StartDesktopRepair()

	_StartProcess()
	GUICtrlSetData($deskBtnGo, "Stop!")

	For $i = 0 To $deskCount
		GuiCtrlSetState($deskRepIco[$i], $GUI_DISABLE)
		GuiCtrlSetState($deskChk[$i], $GUI_DISABLE)
		GuiCtrlSetState($deskRepBtn[$i], $GUI_DISABLE)
	Next

EndFunc


Func _EndDesktopRepair()

	_EndProcess()
	GUICtrlSetData($deskBtnGo, "Go!")

	For $i = 0 To $deskCount
		GUICtrlSetImage($deskRepIco[$i], @ScriptFullPath, 204 + $i)
		GuiCtrlSetState($deskRepIco[$i], $GUI_ENABLE)
		GuiCtrlSetState($deskChk[$i], $GUI_ENABLE)
		GuiCtrlSetState($deskRepBtn[$i], $GUI_ENABLE)
	Next

EndFunc


Func _RunInternetRepair()
	_StartProcess()
	Switch @GUI_CtrlId
		Case $intRepBtn[0]
			_RepairIE()
		Case $intRepBtn[1]
			_RepairPNGFiles()
	EndSwitch
	_EndProcess()
EndFunc


;~ Func _GoInternetRepair()

;~ 	_StartProcess()
;~ 	GUICtrlSetData($intBtnGo, "Stop!")

;~ 	For $i = 0 To $intCount
;~ 		GuiCtrlSetState($intRepIco[$i], $GUI_DISABLE)
;~ 		GuiCtrlSetState($intChk[$i], $GUI_DISABLE)
;~ 		GuiCtrlSetState($intRepBtn[$i], $GUI_DISABLE)
;~ 	Next

;~ 	For $i = 0 To $intCount
;~ 		If GUICtrlRead($intChk[$i]) = $GUI_CHECKED Then
;~ 			If GUICtrlRead($intChk[$i], 1) = " Repair Internet Explorer " & _GetIntExplorerVersion() Then
;~ 				If Not $CancelRepair Then _RepairIE()
;~ 				_SetIntCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($intChk[$i], 1) = " Repair Winsock (Reset Catalog)" Then
;~ 				If Not $CancelRepair Then _RepairWinsock()
;~ 				_SetIntCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($intChk[$i], 1) = " Renew Internet Connections" Then
;~ 				If Not $CancelRepair Then _ReleaseRenewIP()
;~ 				_SetIntCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($intChk[$i], 1) = " Flush DNS Resolver Cache" Then
;~ 				If Not $CancelRepair Then _FlushRegisterDNS()
;~ 				_SetIntCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($intChk[$i], 1) = " PNG images not displayed in Internet Explorer" Then
;~ 				If Not $CancelRepair Then _RepairPNGFiles()
;~ 				_SetIntCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($intChk[$i], 1) = " Clear Windows Update History" Then
;~ 				If Not $CancelRepair Then $CLEARWINUPDATE = True
;~ 				_SetIntCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($intChk[$i], 1) = " Repair Windows / Automatic Updates" Then
;~ 				If GUICtrlRead($intChk[$i]) = $GUI_CHECKED Then
;~ 					GUICtrlSetState($intChk[$i + 1], $GUI_CHECKED)
;~ 				EndIf
;~ 				If Not $CancelRepair Then _RepairWinAutoUpdate()
;~ 				_SetIntCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($intChk[$i], 1) = " Repair SSL / HTTPS / Cryptography" Then
;~ 				If Not $CancelRepair Then _RepairSHC()
;~ 				_SetIntCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($intChk[$i], 1) = " Reset Windows Firewall Configuration" Then
;~ 				If Not $CancelRepair Then _ResetFirewall()
;~ 				_SetIntCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($intChk[$i], 1) = " Restore access to the HOSTS file" Then
;~ 				If Not $CancelRepair Then _RestoreHostsAccess()
;~ 				_SetIntCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($intChk[$i], 1) = " Recover the default HOSTS file" Then
;~ 				If Not $CancelRepair Then _RestoreHosts()
;~ 				_SetIntCompleteStatus($i)
;~ 			ElseIf GUICtrlRead($intChk[$i], 1) = " Repair Workgroup Computers view" Then
;~ 				If Not $CancelRepair Then _RepairWorkGroups()
;~ 				_SetIntCompleteStatus($i)
;~ 			EndIf

;~ 		EndIf
;~ 	Next

;~ 	$RESETWINSOCK = False
;~ 	$CancelRepair = False

;~ 	_EndProcess()
;~ 	GUICtrlSetData($intBtnGo, "Go!")

;~ 	For $i = 0 To $intCount
;~ 		GUICtrlSetImage($intRepIco[$i], @ScriptFullPath, 207 + $i)
;~ 		GuiCtrlSetState($intRepIco[$i], $GUI_ENABLE)
;~ 		GuiCtrlSetState($intChk[$i], $GUI_ENABLE)
;~ 		GuiCtrlSetState($intRepBtn[$i], $GUI_ENABLE)
;~ 	Next

;~ EndFunc


Func _SetIntCompleteStatus($index)
	GUICtrlSetState($intChk[$index], $GUI_UNCHECKED)
	If Not $CancelRepair Then GUICtrlSetImage($intRepIco[$index], @ScriptFullPath, 203)
EndFunc


Func _RunSystemRepair()
	_StartProcess()
	Switch @GUI_CtrlId
		Case $sysRepBtn[0]
			_ResetRegistryPermissions()
		Case $sysRepBtn[1]
			_RegisterSystemFiles()
		Case $sysRepBtn[2]
			_RepairWindowsScript()
	EndSwitch
	_EndProcess()
EndFunc


Func _StartProcess()

	GuiCtrlSetData($eStatus, "")

;~ 	GuiCtrlSetState($FileMenu, $GUI_DISABLE)
;~ 	GuiCtrlSetState($CommMenu, $GUI_DISABLE)
;~ 	GuiCtrlSetState($OpMenu, $GUI_DISABLE)
;~ 	GuiCtrlSetState($HelpMenu, $GUI_DISABLE)

	GuiCtrlSetImage($cwrIco, $processRes)

;~ 	GUICtrlSetState($AppIcon, $GUI_HIDE)
;~ 	GUICtrlSetState($PrAni, $GUI_SHOW)

;~ 	GUICtrlSetData($eStatus, "")
	;GUICtrlSetData($intBtnGo, "Stop!")
;~ 	GuiCtrlSetState($BtnGo, $GUI_FOCUS)
	GUISetCursor(15)
	;For $i = 0 To $intCount
		;GuiCtrlSetState($intRepBtn[$i], $GUI_DISABLE)
		;GuiCtrlSetState($intRepIco[$i], $GUI_DISABLE)
		;GuiCtrlSetState($intChk[$i], $GUI_DISABLE)
	;Next

EndFunc


Func _EndProcess()

;~ 	GuiCtrlSetState($FileMenu, $GUI_ENABLE)
;~ 	GuiCtrlSetState($CommMenu, $GUI_ENABLE)
;~ 	GuiCtrlSetState($OpMenu, $GUI_ENABLE)
;~ 	GuiCtrlSetState($HelpMenu, $GUI_ENABLE)

	GuiCtrlSetImage($cwrIco, @ScriptFullPath, 99)

;~ 	GUICtrlSetState($PrAni, $GUI_HIDE)
;~ 	GUICtrlSetState($AppIcon, $GUI_SHOW)

	;GUICtrlSetData($intBtnGo, "Go!")
;~ 	GuiCtrlSetData($lblWelc,	"All tasks completed. You can ignore most of the errors, because not all " & _
;~ 								"the files being re-registered are the same on every computer. The errors are " & _
;~ 								"displayed to keep track with what is happening to your computer.")
;~ 	GuiCtrlSetColor($lblWelc, 0x066186)

	;For $i = 0 To $intCount
;~ 		GUICtrlSetImage($IcoRep[$i], @ScriptFullPath, 201 + $i)
;~ 		GuiCtrlSetState($IcoRep[$i], $GUI_ENABLE)
		;GuiCtrlSetState($intChk[$i], $GUI_ENABLE)
		;GuiCtrlSetState($intRepBtn[$i], $GUI_ENABLE)
	;Next
	GUISetCursor(-1)

;~ 	GuiCtrlSetState($BtnGo, $GUI_FOCUS)
;~ 	SoundPlay(@ScriptDir & "\Sounds\complete.wav")

EndFunc


